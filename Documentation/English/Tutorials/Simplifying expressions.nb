Notebook[{
Cell[" ", "TutorialColorBar",
 CellMargins->{{Inherited, Inherited}, {-5, 
   0}},ExpressionUUID->"8ff250c3-74e2-443f-86a5-a3396e904d4b"],

Cell[TextData[{
 ButtonBox["BlackHoleAnalysis",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->"paclet:BlackHoleAnalysis/guide/BlackHoleAnalysis"],
 StyleBox[" > ", "LinkTrailSeparator"],
 ButtonBox["Manipulating and simplifying large expressions",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->
   "paclet:BlackHoleAnalysis/tutorial/Manipulating and simplifying large \
expressions"]
}], "LinkTrail",ExpressionUUID->"c16f1c5d-a107-4f6f-a2af-d6ef20eb6bb8"],

Cell[BoxData[GridBox[{
   {Cell["SIMPLIFYING EXPRESSIONS TUTORIAL", "PacletNameCell",ExpressionUUID->
     "6bb9a446-8606-43bf-af94-e0a2a2159099"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"Related Tutorials \[RightGuillemet]\"\>",
        StripOnInput->False], {
       RowBox[{"Field", " ", "equations", " ", "on", " ", "Schwarzschild"}]:>
       Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Field equations on Schwarzschild"], 
       
       RowBox[{"Time", " ", "domain", " ", "amplitudes"}]:>
       Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Time domain amplitudes"], 
       RowBox[{"Equations", " ", "of", " ", "motion"}]:>
       Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Equations of motion"], 
       RowBox[{"Weak", " ", "functions"}]:>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Weak functions"], 
       RowBox[{"Source", " ", "terms"}]:>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Source terms"], 
       RowBox[{
       "Using", " ", "labels", " ", "to", " ", "act", " ", "on", " ", 
        "groups", " ", "of", " ", "variables"}]:>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Using labels to act on groups of \
variables"], "Examples":>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Examples"]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4a8c8956-28e7-4aba-ae05-a2606e4c7970"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"URL \[RightGuillemet]\"\>",
        StripOnInput->False], {"\<\"Go to BlackHoleAnalysis website\"\>":>
       FrontEndExecute[{
         NotebookLocate[{
           URL[None], None}]}], 
       Delimiter, "\<\"Go to wolfram Mathematica website\"\>":>
       FrontEndExecute[{
         NotebookLocate[{
           URL[
           "http://reference.wolfram.com/mathematica/guide/Mathematica.html"],
            None}]}]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "3ad139dc-7f02-4108-95f9-5283b8465fdb"]
    }], "AnchorBar",ExpressionUUID->"1ab4a32f-b39f-4c93-841a-01d0c5044be0"]}
  }]], "AnchorBarGrid",ExpressionUUID->"21335c43-2f42-40a7-9e0f-1f08428f827e"],

Cell[CellGroupData[{

Cell["BlackHoleAnalysis - Manipulating and simplifying expressions", \
"Title",ExpressionUUID->"63b249e0-19ba-48db-bf68-a820e12ef158"],

Cell["\<\
Calculations with BlackHoleAnalysis can often lead to large expressions. Some \
helpful functions are included for keeping these in line\
\>", "Text",ExpressionUUID->"2526c461-db3d-4374-a996-f8596c705c2a"],

Cell[BoxData[
 RowBox[{"<<", "BlackHoleAnalysis`"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"950174a3-485d-4905-bd48-eac3d35ce240"],

Cell[CellGroupData[{

Cell["Source terms and position-dependent quantities", \
"Section",ExpressionUUID->"064b4fb6-1ff8-4cae-9ede-04c1bf0bf1c6"],

Cell[CellGroupData[{

Cell["Removing time derivatives on Schwarzschild", \
"Subsection",ExpressionUUID->"075e422a-b49e-4315-b0d6-25584d3e80d9"],

Cell[CellGroupData[{

Cell["Consider the source term to the CPM variable", \
"Item",ExpressionUUID->"0dafff7c-bd88-41ce-95a0-6f450d830abf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sourceCPM", "=", 
  RowBox[{"MasterEquationSource", "[", 
   RowBox[{
    RowBox[{"Variable", "\[Rule]", "\"\<CPM\>\""}], ",", 
    RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"93d80d8f-d02a-4758-88d4-3e72d0d0bdbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Delta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
      "8", " ", "\[Pi]", " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", " ", "M"}], 
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], \
DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]], "-", 
     FractionBox[
      RowBox[{
      "8", " ", "\[Pi]", " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\
\\\\\"\\\"]\\)\"\>", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], \
DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"8", " ", "\[Pi]", " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", " ", "M"}], 
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
        RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], \
DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]]}], "+", 
     FractionBox[
      RowBox[{
      "8", " ", "\[Pi]", " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\
\\\\\"\\\"]\\)\"\>", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], \
DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
          "8", " ", "\[Pi]", " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
           RowBox[{
            
            SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], " ", 
           RowBox[{
            
            SuperscriptBox["\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\
\\*OverscriptBox[\\\\\\\"X\\\\\\\", \\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\
\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], DisplayForm]\\)\"\>", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
           SuperscriptBox[
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]], "-", 
         FractionBox[
          RowBox[{
          "16", " ", "\[Pi]", " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
           SuperscriptBox[
            RowBox[{
             
             SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
           
           RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], \
DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
           SuperscriptBox[
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}], "3"]}]], "+", 
         FractionBox[
          RowBox[{
          "8", " ", "\[Pi]", " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
           RowBox[{
            
            SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], " ", 
           
           RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], \
DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
           SuperscriptBox[
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]]}], ")"}]}], "\[Lambda]"]}], 
    ")"}]}]}]], "Output",
 CellLabel->"Out[2]=",ExpressionUUID->"91d551fa-10db-47e1-85bf-dc11a7d73623"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "There are terms proportional to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox[
    OverscriptBox["r", "."], "p", "2"], TraditionalForm]],ExpressionUUID->
  "0ef4d2ef-593b-412a-b5da-33b7ebd20280"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["r", ".."], "p"], TraditionalForm]],ExpressionUUID->
  "0f2563d6-c834-4e2f-89a1-229108036fff"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox[
     OverscriptBox["X", "_"], "."], "\[Phi]"], TraditionalForm]],
  ExpressionUUID->"a9a95b6e-3f10-4120-8e6d-12a3694eac1d"],
 ". Each of these terms can be simplified."
}], "Item",ExpressionUUID->"32adb6d7-877f-459e-90bb-4d1a7fc245ce"],

Cell[CellGroupData[{

Cell[TextData[{
 "The term  ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox[
    OverscriptBox["r", "."], "p", "2"], TraditionalForm]],ExpressionUUID->
  "cbb36190-cc1c-4b1d-b6c8-215c5f060f11"],
 "is know from the four velocity constraint ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["u", "\[Alpha]"], 
     SuperscriptBox["u", "\[Alpha]"]}], "=", 
    RowBox[{"-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "56afc4bc-6095-43c4-be3d-5d294d1a33c9"],
 ", and it is removed with RemoveRpDotSquared"
}], "Item",ExpressionUUID->"0395099c-33eb-426d-834f-e51164f0ad67"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveRpDotSquared"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"0c74b227-05d6-486f-b96d-27d70f765395"],

Cell[BoxData[
 RowBox[{"\<\"RemoveRpDotSquared[expr] will replace the square of the first \
derivative of r_p with respect to coordinate time t with an expression \
involving r_p, the black hole mass, and the E and J of the orbit in \
expr.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveRpDotSquared"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info33741357178-9892469",ExpressionUUID->"b972f17a-73c9-4c00-b771-\
1bd25bf66649"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveRpDotSquared", "[", 
  SuperscriptBox[
   RowBox[{
    RowBox[{"rp", "'"}], "[", "t", "]"}], "2"], "]"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"e3a6d776-9277-4a6b-a3fe-ef999a82de61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         SuperscriptBox["\[ScriptCapitalL]", "2"], 
         SuperscriptBox[
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}], "2"]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}], 
     SuperscriptBox["\[ScriptCapitalE]", "2"]]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], 
   "2"]}]], "Output",
 CellLabel->"Out[4]=",ExpressionUUID->"8095ecc4-d9a0-4389-b0cd-9953988984e5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The term ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["r", ".."], "p"], TraditionalForm]],ExpressionUUID->
  "e7b8eccb-ee29-4a8b-9466-0b1a81e707a4"],
 "follows from the equations of motion and is removed with RemoveRpDotDot"
}], "Item",ExpressionUUID->"7818c851-22b7-462d-8ed2-f2863769e44d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveRpDotDot"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"1efd3615-0346-4ec1-89e4-faa63babf410"],

Cell[BoxData[
 RowBox[{"\<\"RemoveRpDotDot[expr] will replace second derivatives of r_p \
with respect to coordinate time t with an expression involving r_p, the black \
hole mass, and the E and J of the orbit in expr.\"\>", "\[NonBreakingSpace]", 
  
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveRpDotDot"]}]], "Print", "PrintUsage",
 CellTags->
  "Info53741357178-9892469",ExpressionUUID->"08292b2d-e045-49e8-b3ec-\
c4d79215c29a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveRpDotDot", "[", 
  RowBox[{
   RowBox[{"rp", "''"}], "[", "t", "]"}], "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"4794a1bf-2b91-4848-b631-7feab98d0f83"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"2", " ", "M"}], 
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      FractionBox[
       RowBox[{"5", " ", "M", " ", 
        SuperscriptBox["\[ScriptCapitalL]", "2"]}], 
       SuperscriptBox[
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}], "2"]], "-", 
      FractionBox[
       SuperscriptBox["\[ScriptCapitalL]", "2"], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}], 
   RowBox[{
    SuperscriptBox["\[ScriptCapitalE]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}], "2"]}]]}]], "Output",
 CellLabel->"Out[6]=",ExpressionUUID->"c60adfba-c4ce-4db4-85ae-3a5b39fbb6a3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["It is usually easier to just call RemoveRpDots", \
"Item",ExpressionUUID->"5f651a73-a6a3-4cee-a3f6-d3bd707fe009"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveRpDots"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"42123105-15cb-4ad4-9156-341d8298b8eb"],

Cell[BoxData[
 RowBox[{"\<\"RemoveRpDots[expr] calls RemoveRpDotDot[expr] followed by \
RemoveRpDotSquared[expr].\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveRpDots"]}]], "Print", "PrintUsage",
 CellTags->
  "Info73741357178-9892469",ExpressionUUID->"9370d888-87f2-47e2-9bfc-\
31a089d11985"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "The term ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox[
     OverscriptBox["X", "_"], "."], "\[Phi]"], TraditionalForm]],
  ExpressionUUID->"9ccf15b2-9440-4b0c-8c4e-2fee9c87b242"],
 " is the time derivative of a spherical harmonic (which has been evaluated \
at the location of the particle). "
}], "Item",ExpressionUUID->"9876435c-cdaf-4b50-a43a-4b549bfa206b"],

Cell[TextData[{
 "Since we are only interested in motion in the orbital plane, the only time \
dependence in the harmonic is in the term ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{"-", " ", "\[ImaginaryI]"}], " ", "m", " ", 
     RowBox[{
      SubscriptBox["\[Phi]", "p"], "[", "t", "]"}]}]], TraditionalForm]],
  ExpressionUUID->"1f06cba3-19f0-4cce-b7cf-86dac9f0c967"]
}], "Item",ExpressionUUID->"8f65c456-a91e-4635-9b69-ed319a4b14ae"],

Cell[CellGroupData[{

Cell["\<\
We simplify time derivatives of spherical harmonics with the function \
RemoveSHDots\
\>", "Item",ExpressionUUID->"ad5dfcbe-5348-455d-81b5-c302f0731a79"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveSHDots"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"c44304a2-8653-4405-8654-b4efdb48fe55"],

Cell[BoxData[
 RowBox[{"\<\"RemoveSHDots[expr] replaces coordinate time derivatives of \
scalar and vector spherical harmonics in expr with higher-order vector or \
tensor harmonics.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveSHDots"]}]], "Print", "PrintUsage",
 CellTags->
  "Info83741357178-9892469",ExpressionUUID->"b34333ca-40e9-4537-a2f6-\
99df3012be41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xPhiSym", "=", 
  RowBox[{"XPhiSymbol", "[", 
   RowBox[{"Conjugate", "\[Rule]", "True"}], "]"}]}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"020c48ba-b3a9-4045-a9e3-3037f432589b"],

Cell[BoxData["\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\\\"], \
DisplayForm]\\)\"\>"], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"df2c90d3-75d7-4ba7-bf8e-e51ec53e508a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveSHDots", "[", 
  RowBox[{
   RowBox[{"xPhiSym", "'"}], "[", "t", "]"}], "]"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"a47b6318-cba2-4176-9546-afceff74ceb9"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ScriptCapitalL]", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*OverscriptBox[\
\\\\\\\"X\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\[Phi]\
\\\"], DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
  RowBox[{"\[ScriptCapitalE]", " ", 
   SuperscriptBox[
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]]], "Output",
 CellLabel->"Out[10]=",ExpressionUUID->"5fb5cf87-b3e8-4bbe-ae47-9b3fb76e28db"]

}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "At times we will also have cause to remove the time derivatives of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "p"], "[", "t", "]"}], TraditionalForm]],
  ExpressionUUID->"c8d4f00e-bde0-453f-be28-fa388ad769f7"],
 ", which the four velocity provides"
}], "Item",ExpressionUUID->"d29d0caa-69e3-424d-b036-099d2954abe8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemovePhiPDots"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"6f15bcf9-4999-4e70-a904-66137a3d34c1"],

Cell[BoxData[
 RowBox[{"\<\"RemovePhiPDots[expr] will replace coordinate time derivatives \
of the azimuthal position phi_p of the particle with expressions involving \
r_p[t], its derivatives, and the specific energy and angular momentum, E and \
J, of the orbit.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemovePhiPDots"]}]], "Print", "PrintUsage",
 CellTags->
  "Info113741357179-9892469",ExpressionUUID->"590914a6-b2f4-4a4a-9f8c-\
ba6c0f4d7276"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemovePhiPDots", "[", 
  RowBox[{
   RowBox[{"\[Phi]p", "'"}], "[", "t", "]"}], "]"}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"2e5d4f9d-5d01-464a-a72e-b9510ad45852"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ScriptCapitalL]", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}], 
  RowBox[{"\[ScriptCapitalE]", " ", 
   SuperscriptBox[
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]]], "Output",
 CellLabel->
  "Out[12]=",ExpressionUUID->"5c0c18ff-99e2-4c0f-a4b0-0cc18381cdc5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expanding spherical harmonics", \
"Subsection",ExpressionUUID->"028f1c90-7d97-4cc3-9b01-b049b33a6a5b"],

Cell["Spherical harmonics are usually written symbolically.", \
"Item",ExpressionUUID->"00aa2c23-1622-445a-b3a0-00e21fd25d50"],

Cell["Sometimes we wish to expand them explicitly.", \
"Item",ExpressionUUID->"3672cd44-e633-42a1-b344-9e2cc08bc146"],

Cell[CellGroupData[{

Cell["This is performed with the function ExpandHarmonics.", \
"Item",ExpressionUUID->"b9ceac4f-88be-45e7-8f65-256a7430ca6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "ExpandHarmonics"}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"3a4107bf-fa81-4d3b-9b51-dd5cf6dc081e"],

Cell[BoxData[
 RowBox[{"\<\"ExpandHarmonics[expr] expands symbolic scalar, vector and \
tensor spherical harmonic in terms of trigonometric terms.\"\>", 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/ExpandHarmonics"]}]], "Print", "PrintUsage",
 
 CellTags->
  "Info133741357179-9892469",ExpressionUUID->"9277f689-32d3-4991-99ff-\
b3b4268de57d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"yPhi", "=", 
  RowBox[{"YPhiSymbol", "[", "]"}]}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"67a4edc0-5b90-4e3e-bba0-23308d09d653"],

Cell[BoxData["\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"Y\\\\\\\"}]\\\\)\\\", \\\"\[Phi]\\\"], DisplayForm]\\)\"\>"], "Output",
 CellLabel->
  "Out[14]=",ExpressionUUID->"47f80047-d1e6-46bc-97a9-883a3c454dc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpandHarmonics", "[", 
  RowBox[{"yPhi", "[", "t", "]"}], "]"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"aad04817-2fcb-4433-a675-9f3ccbe3db0a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "m", " ", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Phi]\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]}]], " ", "m", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "l"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"l", "+", "m"}], ")"}], "!"}]]], " ", 
   RowBox[{"LegendreP", "[", 
    RowBox[{"l", ",", "m", ",", "0"}], "]"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["\[Pi]"]}]]], "Output",
 CellLabel->
  "Out[15]=",ExpressionUUID->"8ef74607-1659-4bff-8395-e66ca47da27f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
At times spherical harmonics will have Legendre polynomials which can be \
further simplified. This can be done with ReduceLegendreP.\
\>", "Item",ExpressionUUID->"5aed8d26-04d8-4a7d-91b1-d04a7dcfe9bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "ReduceLegendreP"}]], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"49cc1bd7-81bb-47e1-b5e9-5dff1ba4d35e"],

Cell[BoxData[
 RowBox[{"\<\"ReduceLegendreP[expr] lowers the order of the first argument of \
LegendreP if possible.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/ReduceLegendreP"]}]], "Print", "PrintUsage",
 
 CellTags->
  "Info163741357179-9892469",ExpressionUUID->"c489369f-82ea-4a44-bab1-\
4475abe794ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReduceLegendreP", "[", 
  RowBox[{"LegendreP", "[", 
   RowBox[{
    RowBox[{"l", "+", "2"}], ",", "m", ",", "0"}], "]"}], "]"}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"24d28227-6688-4b02-905c-f551687767eb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
   RowBox[{"LegendreP", "[", 
    RowBox[{"l", ",", "m", ",", "0"}], "]"}]}], 
  RowBox[{
   RowBox[{"-", "2"}], "-", "l", "+", "m"}]]], "Output",
 CellLabel->
  "Out[17]=",ExpressionUUID->"2c578234-2425-4930-8626-909e76649deb"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mode numbers", \
"Subsection",ExpressionUUID->"64f90f94-0a44-47bf-a90e-99a014400e42"],

Cell["Some expression are written in terms of \[Lambda]=(l+2)(l-1)/2.", \
"Item",ExpressionUUID->"3d8413e8-0f0a-4579-9d32-ea99c2c0c1f1"],

Cell[CellGroupData[{

Cell["We can return to the usual \[ScriptL] with LambdaToL", \
"Item",ExpressionUUID->"2d102a2d-4596-494e-8fa1-4598b20f17af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "LambdaToL"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"7425c3fd-b8f0-482e-b725-aa06a1e8ba09"],

Cell[BoxData[
 RowBox[{"\<\"LambdaToL[expr] converts all lambdas in expr to \
(l+2)(l-1)/2\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/LambdaToL"]}]], "Print", "PrintUsage",
 CellTags->
  "Info183741357179-9892469",ExpressionUUID->"85ec3abe-488e-4331-a2ee-\
73ea04556c22"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LambdaToL", "[", 
  RowBox[{"\[Lambda]", "+", "2"}], "]"}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"660a0909-90b7-4419-93c2-1c977645f671"],

Cell[BoxData[
 RowBox[{"2", "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", "l"}], ")"}]}]}]], "Output",
 CellLabel->
  "Out[19]=",ExpressionUUID->"33f5e6cf-63fe-4eb8-a814-9b8aafaa5411"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Manipulating large expressions", \
"Subsection",ExpressionUUID->"8aa7354e-ac10-4fbb-8027-fdee0c537d09"],

Cell[CellGroupData[{

Cell["\<\
Returning to our source function at the top of this tutorial, we can now \
simplify it greatly.\
\>", "Item",ExpressionUUID->"e7aab395-e662-4b6a-aae8-7fc697bced7e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"LambdaToL", "@", 
    RowBox[{"RemoveRpDots", "@", 
     RowBox[{"RemovePhiPDots", "@", 
      RowBox[{"ExpandHarmonics", "[", "sourceCPM", "]"}]}]}]}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"r", "-", 
     RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"a4ad7b18-063a-4c57-a758-581b131b62cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"16", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Phi]\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
     SqrtBox["\[Pi]"], " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "l"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "m"}], ")"}], "!"}]]], " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", "m", ",", "0"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "M"}], "-", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"r", "-", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "14"}], " ", 
        SuperscriptBox["M", "2"], " ", 
        SuperscriptBox["\[ScriptCapitalL]", "2"]}], "+", 
       RowBox[{"11", " ", "M", " ", 
        SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           SuperscriptBox["M", "2"]}], "+", 
          SuperscriptBox["\[ScriptCapitalL]", "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ScriptCapitalE]", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "4"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", " ", 
           RowBox[{"(", 
            RowBox[{"7", "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["\[ScriptCapitalE]", "2"]}]}], ")"}]}], "+", 
          RowBox[{
          "\[ImaginaryI]", " ", "m", " ", "\[ScriptCapitalE]", " ", 
           "\[ScriptCapitalL]", " ", 
           RowBox[{
            
            SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", "l", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "l"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "l"}], ")"}], " ", 
     SuperscriptBox["\[ScriptCapitalE]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "7"]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"16", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Phi]\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
     SqrtBox["\[Pi]"], " ", "\[ScriptCapitalL]", " ", "\[Mu]", " ", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "l"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "m"}], ")"}], "!"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "m"}], ")"}], "!"}]]], " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", "m", ",", "0"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "M"}], "+", 
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], ")"}], "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ScriptCapitalL]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}], "2"]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[Delta]", "\[Prime]",
       MultilineFunction->None], "[", 
      RowBox[{"r", "-", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", "l", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "l"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "l"}], ")"}], " ", 
     SuperscriptBox["\[ScriptCapitalE]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "6"]}], 
    ")"}]}]}]], "Output",
 CellLabel->
  "Out[20]=",ExpressionUUID->"b68eed41-cbdd-4362-b8cf-b7df09f90bac"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transforming between different variables", "Section",
 CellChangeTimes->{{3.74127880299056*^9, 
  3.74127881257303*^9}},ExpressionUUID->"506ad39e-1d6e-46f8-aa1c-\
02d66dbe9d71"],

Cell[CellGroupData[{

Cell["The even and odd-parity master functions", "Subsection",
 CellChangeTimes->{{3.74127881934076*^9, 
  3.741278828307571*^9}},ExpressionUUID->"025f5b80-990f-4f56-be97-\
4303dcf0f627"],

Cell["\<\
Transformations due to Detweiler and Chandrasekhar relate the parities of the \
master functions.\
\>", "Item",
 CellChangeTimes->{{3.741278831288473*^9, 
  3.7412788893005867`*^9}},ExpressionUUID->"6c457d9a-d814-4df0-86fb-\
bea080a0b9bb"],

Cell[CellGroupData[{

Cell["This transformation only exists in the frequency domain.", "Item",
 CellChangeTimes->{{3.741278831288473*^9, 
  3.741278911789445*^9}},ExpressionUUID->"08ca5363-709f-4aaf-be39-\
71b1ecd6c02f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "EvenMasterFunctionAsOdd"}]], "Input",
 CellChangeTimes->{{3.741278875337204*^9, 3.741278881245893*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"7e765820-69f4-4b51-ba49-7cdf4668e38f"],

Cell[BoxData[
 RowBox[{"\<\"EvenMasterFunctionAsOdd[] returns the frequency domain \
even-parity master function written in terms of the odd-parity function.\"\>",
   "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/EvenMasterFunctionAsOdd"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info213741357180-9892469",ExpressionUUID->"cae8155c-c196-4d03-a117-\
46d9df8f4365"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvenMasterFunctionAsOdd", "[", "]"}]], "Input",
 CellChangeTimes->{{3.741278884620784*^9, 3.741278884704661*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"3280a101-3c89-4368-a4ce-f20b51d39a2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[Lambda]", "+", 
     SuperscriptBox["\[Lambda]", "2"], "+", 
     FractionBox[
      RowBox[{"9", " ", 
       SuperscriptBox["M", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"CPM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", "r", "]"}]}], "+", 
  RowBox[{"3", " ", "M", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"CPM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "\[Prime]",
     MultilineFunction->None], "[", "r", "]"}]}]}]], "Output",
 CellLabel->
  "Out[22]=",ExpressionUUID->"5998d8b2-d4d3-405e-bfa8-60937e5fdac1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Teukolsky and master functions", "Subsection",
 CellChangeTimes->{{3.74127893102822*^9, 
  3.741278940542323*^9}},ExpressionUUID->"1f06f55e-385f-4ef5-8e68-\
8ec6a27fc5e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MasterFunctionAsTeukolskyFunction"}]], "Input",
 CellChangeTimes->{{3.7412789492354927`*^9, 3.741278949447866*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"86b4666b-89ef-4348-93d6-6b0725b351b4"],

Cell[BoxData[
 RowBox[{"\<\"MasterFunctionAsTeukolskyFunction[] returns the frequency \
domain master function written in terms of the Teukolsky function and its \
first r derivative.\\nMasterFunctionAsTeukolskyFunction[n] returns the nth r \
derivative frequency domain master function written in terms of the Teukolsky \
function and its first r derivative.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/MasterFunctionAsTeukolskyFunction"]}]], \
"Print", "PrintUsage",
 CellTags->
  "Info233741357180-9892469",ExpressionUUID->"5283df20-4dc8-495e-ac0d-\
b7ea84fb080f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MasterFunctionAsTeukolskyFunction", "[", 
  RowBox[{"Parity", "\[Rule]", "\"\<Even\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MasterFunctionAsTeukolskyFunction", "[", 
  RowBox[{"Parity", "\[Rule]", "\"\<Odd\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.74127894295481*^9, 3.7412789456471148`*^9}, {
  3.741330516360136*^9, 3.741330534500882*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"5f5428f9-4816-4e48-8481-30cc77d115fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["M", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[Lambda]"}], "-", 
          RowBox[{"7", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Lambda]", "+", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "-", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "-", 
       RowBox[{"M", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]", "2"]}], "+", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"(", 
            RowBox[{"9", "+", 
             RowBox[{"9", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
             ")"}]}], "+", 
          RowBox[{"3", " ", "r", " ", "\[Omega]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "\[ImaginaryI]"}], "+", 
             RowBox[{"r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
     " ", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "[", "r", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "M"}], "+", 
       RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "6"}], " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
      RowBox[{"6", " ", "\[ImaginaryI]", " ", "M", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "\[Lambda]"}], "+", 
         RowBox[{"r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}]], "Output",
 CellLabel->"Out[24]=",ExpressionUUID->"0ee253ed-a8ce-413c-8813-964106bcf5f0"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"12", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"M", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "12"}], "-", 
         RowBox[{"2", " ", "\[Lambda]"}], "-", 
         RowBox[{"9", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
        ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "\[Lambda]", "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "-", 
         
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\
\\)\"\>", "[", "r", "]"}]}], 
   RowBox[{"r", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], 
     ")"}], " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "M"}], "+", "r"}]]}]], "Output",
 CellLabel->
  "Out[25]=",ExpressionUUID->"abaf17e0-7b44-4145-84f6-d5a6576a27dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sasaki-Nakamura function as Teukolsky function", "Subsection",
 CellChangeTimes->{{3.7412789782309437`*^9, 
  3.741279001356883*^9}},ExpressionUUID->"6a5f70dc-6fbc-408e-a455-\
68203c9a3553"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SasakiNakamuraFunctionAsTeukolskyFunction", "[", "]"}]], "Input",
 CellChangeTimes->{{3.741278964005117*^9, 3.741278968318036*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"0ffd396c-a80f-4cea-9663-454e27569c80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["r", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", 
          SuperscriptBox["a", "3"], " ", "m", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "+", 
            RowBox[{"r", " ", "\[Omega]"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
            "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", "a", " ", "m", " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "\[ImaginaryI]", " ", "M"}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], "+", 
               RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "24"}], " ", 
             SuperscriptBox["M", "2"]}], "+", 
            RowBox[{"2", " ", "M", " ", "r", " ", 
             RowBox[{"(", 
              RowBox[{
              "12", "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "+", 
               RowBox[{
               "9", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
              ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "6"}], 
               "-", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
               RowBox[{"8", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}],
                "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["r", "2"], " ", 
                SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          SuperscriptBox["a", "2"], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"6", " ", "M", " ", 
             RowBox[{"(", 
              RowBox[{"4", "+", 
               RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
              ")"}]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "12"}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["m", "2"]}], 
               "-", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
               RowBox[{
               "12", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["r", "2"], " ", 
                SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \\\"\\\\\\\"-2\\\\\\\"\\\
\"]\\)\"\>", "[", "r", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], 
        "2"]}], ")"}]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "m", " ", "r"}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}],
         ")"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
     ")"}]}]]}]], "Output",
 CellLabel->
  "Out[26]=",ExpressionUUID->"646e822e-1104-47e0-b4db-b807a8dc3ea8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Teukolsky function as Sasaki-Nakamura function", "Subsection",
 CellChangeTimes->{{3.7412789782309437`*^9, 
  3.74127899210712*^9}},ExpressionUUID->"c19c41d8-3dc7-415e-bcde-\
d8afd849f88e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeukolskyFunctionAsSasakiNakamuraFunction", "[", "]"}]], "Input",
 CellChangeTimes->{{3.741278964005117*^9, 3.741278968318036*^9}, {
  3.741279002716563*^9, 3.7412790042066317`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"b320755b-29f0-44f9-ad0b-a000e3dc3797"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        SuperscriptBox["a", "5"], " ", "m", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], "+", 
          RowBox[{"r", " ", "\[Omega]"}]}], ")"}]}], "+", 
       RowBox[{"a", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "M", " ", 
           SuperscriptBox["r", "4"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "6"], " ", "\[Omega]"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "6"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "-", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "3"], " ", "m", " ", 
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "M"}], "+", 
          RowBox[{"2", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "+", 
             RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SuperscriptBox["r", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "12"}], " ", 
           SuperscriptBox["M", "2"]}], "+", 
          RowBox[{"2", " ", "M", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
            "5", "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "+", 
             RowBox[{"3", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
             ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], 
             "-", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
             "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "12"}], " ", 
           SuperscriptBox["M", "2"]}], "+", 
          RowBox[{"M", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
            "19", "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\\\
\\\"-2\\\\\\\"\\\"]\\)\"\>", "+", 
             RowBox[{"6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
             ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "6"}], "+", 
             SuperscriptBox["m", "2"], 
             "-", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
             RowBox[{"4", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
             "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["a", "4"], " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", " ", 
           RowBox[{"(", 
            RowBox[{"32", "+", 
             RowBox[{"6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
             ")"}]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "20"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["m", "2"]}], 
             "-", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
             RowBox[{"10", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
             "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], " ", 
     RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"X\\\\\\\"\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\", \\\"\\\\\\\"SN\\\\\\\"\\\"], \\\"Subsuperscript\\\", \
Rule[SyntaxForm, SubsuperscriptBox]]\\)\"\>", "[", "r", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        SuperscriptBox["r", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "4"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
          
          SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "-", 
          RowBox[{"12", " ", "\[ImaginaryI]", " ", "M", " ", "\[Omega]"}]}], 
         ")"}]}], "+", 
       RowBox[{"24", " ", 
        SuperscriptBox["a", "3"], " ", "m", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "-", 
          RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", "a", " ", "m", " ", 
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", "\[ImaginaryI]", " ", "M"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "\[ImaginaryI]", 
              " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
             RowBox[{"3", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["a", "2"], " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
             ")"}]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["m", "2"]}], "+", 
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], 
                "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\\\\\
\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", " ", 
     SuperscriptBox["r", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], " ", 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "m", " ", "r"}], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], ")"}]}], 
       "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "M"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
            ")"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"X\\\\\\\"\\\",\
 \\\"\\\\\\\"-2\\\\\\\"\\\", \\\"\\\\\\\"SN\\\\\\\"\\\"], \
\\\"Subsuperscript\\\", Rule[SyntaxForm, SubsuperscriptBox]]\\)\"\>", 
       "\[Prime]",
       MultilineFunction->None], "[", "r", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["r", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "4"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
          
          SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "-", 
          RowBox[{"12", " ", "\[ImaginaryI]", " ", "M", " ", "\[Omega]"}]}], 
         ")"}]}], "+", 
       RowBox[{"24", " ", 
        SuperscriptBox["a", "3"], " ", "m", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{"\[ImaginaryI]", "-", 
          RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["a", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "-", 
       RowBox[{"4", " ", "a", " ", "m", " ", 
        SuperscriptBox["r", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", "\[ImaginaryI]", " ", "M"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "\[ImaginaryI]", 
              " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
             RowBox[{"3", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["a", "2"], " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
             ")"}]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["m", "2"]}], "+", 
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], 
                "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\\\\\
\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}], ")"}]}]}]], "Output",
 CellLabel->
  "Out[27]=",ExpressionUUID->"d4d21b0c-7b3f-4c62-b396-78d1566f2cf9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using ODEs to reduce the order of derivatives", \
"Section",ExpressionUUID->"efeb1b24-62a1-4452-8672-643ac47e807f"],

Cell[CellGroupData[{

Cell["The RWZ master equation", \
"Subsection",ExpressionUUID->"8c85787a-ade7-43a9-b5c0-b6c2b1843e05"],

Cell["\<\
When working in the frequency domain, the RWZ equation can be thought of as a \
relationship between the r-derivatives of the master function.\
\>", "Item",ExpressionUUID->"15874f04-e6f7-4479-802b-f07942400ebe"],

Cell[CellGroupData[{

Cell["\<\
This can be exploited to lower the order of derivatives in an expression.\
\>", "Item",ExpressionUUID->"150e21fe-f122-413c-82e1-c07e3db8a7ba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveMasterFunctionRDerivatives"}]], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"97533c72-7f4e-449e-8808-dce26bcd59cb"],

Cell[BoxData[
 RowBox[{"\<\"RemoveMasterFunctionRDerivatives[expr] uses the master equation \
to remove all r derivatives of the master function higher than the \
first.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveMasterFunctionRDerivatives"]}]], \
"Print", "PrintUsage",
 CellTags->
  "Info283741357180-9892469",ExpressionUUID->"070cdd43-c32e-4cb3-8986-\
5bc867fd6d45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dr2X", "=", 
  RowBox[{"ToFrequencyDomain", "@", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"MasterFunction", "[", 
      RowBox[{"Parity", "\[Rule]", "\"\<Odd\>\""}], "]"}], ",", "r", ",", 
     "r"}], "]"}]}]}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"b8906ff2-bf3a-4db9-8652-3853bdeac5b5"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"CPM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "\[Prime]\[Prime]",
   MultilineFunction->None], "[", "r", "]"}]], "Output",
 CellLabel->
  "Out[29]=",ExpressionUUID->"6e44aa4e-4e19-4fed-89bf-f9576bc8adab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveMasterFunctionRDerivatives", "[", 
  RowBox[{"dr2X", ",", 
   RowBox[{"Homogeneous", "\[Rule]", "True"}], ",", 
   RowBox[{"FD", "\[Rule]", "True"}], ",", 
   RowBox[{"Parity", "\[Rule]", "\"\<Odd\>\""}]}], "]"}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"9c92d17d-bef5-4d50-813b-9ea02d5631c4"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"12", " ", 
       SuperscriptBox["M", "2"]}], "-", 
      RowBox[{"2", " ", "M", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", 
         RowBox[{"2", " ", "\[Lambda]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", "\[Lambda]"}], "-", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"CPM\\\\\\\"\
\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     "r", "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"CPM\
\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>",
       "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{
    RowBox[{"2", " ", "M", " ", "r"}], "-", 
    SuperscriptBox["r", "2"]}]]}]], "Output",
 CellLabel->
  "Out[30]=",ExpressionUUID->"befc345c-a10b-4ff1-b63a-944138f53d1c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The radial Teukolsky equation", \
"Subsection",ExpressionUUID->"3d89df14-135a-4dca-94c5-76176b2c13d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveTeukolskyFunctionRDerivatives"}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"9ce04971-0258-468d-8c08-086d6bde8b4b"],

Cell[BoxData[
 RowBox[{"\<\"RemoveTeukolskyFunctionRDerivatives[expr] uses the radial \
Teukolsky equation to remove all r derivatives of the Teukolsky function \
higher than the first.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveTeukolskyFunctionRDerivatives"]}]], \
"Print", "PrintUsage",
 CellTags->
  "Info313741357181-9892469",ExpressionUUID->"1a78121a-7798-468e-99b0-\
349ee0c3144d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2rTeuk", "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"RadialTeukolskyFunction", "[", "]"}], ",", "r", ",", "r"}], 
   "]"}]}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"a4b5fadd-38ae-4387-8dc7-fea931c669d7"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \\\"\\\\\\\"-2\\\\\\\"\
\\\"]\\)\"\>", "\[Prime]\[Prime]",
   MultilineFunction->None], "[", "r", "]"}]], "Output",
 CellLabel->
  "Out[32]=",ExpressionUUID->"745385c5-b9fd-40a7-934d-66ceb9d8a343"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveTeukolskyFunctionRDerivatives", "[", "d2rTeuk", 
  "]"}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"6d626867-f98c-4d82-b568-85378a5e6fcc"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\\\\\"-2\\\\\
\\\"\\\"]\\)\"\>", "+", 
      RowBox[{"8", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", "m"}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "\[Omega]"}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", "\[Omega]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", "m"}], "-", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "M"}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "\[Omega]"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "\[ImaginaryI]"}], "+", 
             RowBox[{"r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["a", "2"], "+", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}]]}], ")"}], 
    " ", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\
\\)\"\>", "[", "r", "]"}]}], 
   RowBox[{
    SuperscriptBox["a", "2"], "+", 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"M", "-", "r"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"R\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
      MultilineFunction->None], "[", "r", "]"}]}], 
   RowBox[{
    SuperscriptBox["a", "2"], "+", 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}]]}]], "Output",
 CellLabel->
  "Out[33]=",ExpressionUUID->"f2a13d9e-4b26-4829-b1f2-e78976267059"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The angular Teukolsky equation", \
"Subsection",ExpressionUUID->"6f5c12f3-2c51-4014-88c2-bc0b880fdd2c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveSlmThetaDerivatives"}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"53073b72-cbf5-44eb-8f39-3859af31200b"],

Cell[BoxData[
 RowBox[{"\<\"RemoveSlmThetaDerivatives[expr] uses the angular Teukolsky \
equation to remove all theta derivatives of the angular function Slm higher \
than the first.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveSlmThetaDerivatives"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info343741357181-9892469",ExpressionUUID->"87dd7c72-3746-4df5-9185-\
12897e89ed09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2ThSlm", "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"SpinWeightedSpheroidalHarmonicFunction", "[", "]"}], ",", 
    "\[Theta]", ",", "\[Theta]"}], "]"}]}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"0683639a-d7ac-477a-98ac-c0acb3bab5c1"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\\\\\\\"\\\\\\\"\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)S\"\>", "\[Prime]\[Prime]",
   MultilineFunction->None], "[", "\[Theta]", "]"}]], "Output",
 CellLabel->
  "Out[35]=",ExpressionUUID->"47ef3954-769f-47ea-9b29-ce15b23e75ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveSlmThetaDerivatives", "[", "d2ThSlm", "]"}]], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"d74eee11-f511-422b-b437-e5e3183ec2f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
    "2", "-", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
     RowBox[{"2", " ", "a", " ", "m", " ", "\[Omega]"}], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["\[Omega]", "2"]}], "-", 
     RowBox[{"4", " ", "a", " ", "\[Omega]", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["\[Omega]", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"Cot", "[", "\[Theta]", "]"}], "2"]}], "-", 
     RowBox[{"4", " ", "m", " ", 
      RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Csc", "[", "\[Theta]", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\\\\\\\"\\\\\\\"\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)S\"\>", "[", "\[Theta]", "]"}]}], "-", 
  RowBox[{
   RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\\\\\\\"\\\\\\\"\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)S\"\>", "\[Prime]",
     MultilineFunction->None], "[", "\[Theta]", "]"}]}]}]], "Output",
 CellLabel->
  "Out[36]=",ExpressionUUID->"e9e20d4c-7d0e-4e21-a45f-a2e4742e6255"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Sasaki-Nakamura equation", \
"Subsection",ExpressionUUID->"1648a43d-0bca-4156-9154-69370fe44a5b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveSasakiNakamuraFunctionRDerivatives"}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"f18516a2-eee1-4353-ad39-1e0c0fffea73"],

Cell[BoxData[
 RowBox[{"\<\"RemoveSasakiNakamuraFunctionRDerivatives[expr] uses the \
Sasaki-Nakamura equation to remove all r derivatives of the Sasaki-Nakamura \
function higher than the first.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveSasakiNakamuraFunctionRDerivatives"]}]\
], "Print", "PrintUsage",
 CellTags->
  "Info373741357181-9892469",ExpressionUUID->"11fc5e6b-59c6-4dc2-a68f-\
27c21d9cb6ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2rSN", "=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"SasakiNakamuraFunction", "[", "]"}], ",", "r", ",", "r"}], 
   "]"}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"511ecf7d-9210-4727-b1d6-2e9b80d9d7fc"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"X\\\\\\\"\\\", \\\
\"\\\\\\\"-2\\\\\\\"\\\", \\\"\\\\\\\"SN\\\\\\\"\\\"], \
\\\"Subsuperscript\\\", Rule[SyntaxForm, SubsuperscriptBox]]\\)\"\>", 
   "\[Prime]\[Prime]",
   MultilineFunction->None], "[", "r", "]"}]], "Output",
 CellLabel->
  "Out[38]=",ExpressionUUID->"526b40ee-0a59-4195-b1f4-c91b2bf4c457"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveSasakiNakamuraFunctionRDerivatives", "[", "d2rSN", 
  "]"}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"fefd53de-3781-4196-a57f-61060def0cd8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}], "2"]], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["r", "2"]}], ")"}], "4"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r", "3"], "+", 
              RowBox[{
               SuperscriptBox["a", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
             ")"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "4"], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["a", "2"], " ", "M", " ", "r"}], "-", 
             SuperscriptBox["r", "4"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", " ", "a", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               SuperscriptBox["r", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r", "3"], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "m", " ", 
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"6", " ", "M"}], "+", 
                  RowBox[{
                  "r", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}]}], ")"}]}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["a", "2"], " ", "m", " ", "r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "\[ImaginaryI]"}], "-", 
                  RowBox[{"4", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["a", "3"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "6"}], "-", 
                  RowBox[{
                  "9", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
                  RowBox[{"6", " ", 
                   SuperscriptBox["r", "2"], " ", 
                   SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
               RowBox[{"a", " ", "r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"M", " ", 
                   RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["m", "2"]}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], 
                    "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["r", "4"]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                  
                  SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\",\
 \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "-", 
                  RowBox[{
                  "12", " ", "\[ImaginaryI]", " ", "M", " ", "\[Omega]"}]}], 
                 ")"}]}], "+", 
               RowBox[{"24", " ", 
                SuperscriptBox["a", "3"], " ", "m", " ", "r", " ", 
                RowBox[{"(", 
                 RowBox[{"\[ImaginaryI]", "-", 
                  RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
               RowBox[{"12", " ", 
                SuperscriptBox["a", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "-", 
                  RowBox[{
                  "2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["r", "2"], " ", 
                   SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "-", 
               RowBox[{"4", " ", "a", " ", "m", " ", 
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"6", " ", "\[ImaginaryI]", " ", "M"}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                    RowBox[{"3", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["a", "2"], " ", "r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"M", " ", 
                   RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["m", "2"]}], "+", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], 
                    "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}],
               ")"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "+", 
              SuperscriptBox["r", "2"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], ")"}],
            " ", 
           RowBox[{"(", 
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "+", 
             RowBox[{"8", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
             "-", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "a"}], " ", "m"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    SuperscriptBox["r", "2"]}], ")"}], " ", "\[Omega]"}]}], 
                ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "a"}], " ", "m"}], "+", 
                 RowBox[{"4", " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "M"}], "+", "r"}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["a", "2"], "+", 
                    SuperscriptBox["r", "2"]}], ")"}], " ", "\[Omega]"}]}], 
                ")"}]}], 
              RowBox[{
               SuperscriptBox["a", "2"], "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}]], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"4", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"12", " ", 
                   SuperscriptBox["a", "7"], " ", "m", " ", 
                   SuperscriptBox["r", "2"], " ", "\[Omega]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    "3", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "+", 
                  RowBox[{"6", " ", 
                   SuperscriptBox["a", "8"], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "-", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["\[Omega]", "3"]}]}], ")"}]}], "-", 
                  RowBox[{
                   SuperscriptBox["r", "6"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                    
                    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "-", 
                    RowBox[{
                    "12", " ", "\[ImaginaryI]", " ", "M", " ", "\[Omega]"}]}],
                     ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    SuperscriptBox["M", "2"]}], "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SuperscriptBox["r", "3"], " ", "\[Omega]"}], "+", 
                    RowBox[{"M", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{
                    "3", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                   SuperscriptBox["a", "5"], " ", "m", " ", 
                   SuperscriptBox["r", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"M", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "15"}], "-", 
                    RowBox[{
                    "48", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
                     ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{"15", "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["m", "2"]}], "-", 
                    RowBox[{
                    "7", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                    RowBox[{
                    "30", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "r", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", "\[Omega]"}], "+", 
                    RowBox[{"42", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], 
                  "-", 
                  RowBox[{"2", " ", "\[ImaginaryI]", " ", 
                   SuperscriptBox["a", "3"], " ", "m", " ", 
                   SuperscriptBox["r", "3"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["M", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "30"}], "-", 
                    RowBox[{
                    "24", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
                     ")"}]}], "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m", "2"]}], "-", 
                    RowBox[{
                    "4", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "r", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", "\[Omega]"}], "+", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"M", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{"33", "-", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{"84", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "+", 
                    
                    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "22"}], "-", 
                    RowBox[{"4", " ", "\[ImaginaryI]", " ", "r", " ", 
                    "\[Omega]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
                  RowBox[{"\[ImaginaryI]", " ", "a", " ", "m", " ", 
                   SuperscriptBox["r", "4"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"24", " ", 
                    SuperscriptBox["M", "3"]}], "+", 
                    RowBox[{"24", " ", 
                    SuperscriptBox["M", "2"], " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], 
                    "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "+", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{
                    SuperscriptBox["r", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    
                    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "+", 
                    RowBox[{
                    "10", " ", "\[ImaginaryI]", " ", "r", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", "\[Omega]"}], "+", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"M", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    
                    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "+", 
                    RowBox[{"36", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "+", 
                    
                    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "18"}], "+", 
                    RowBox[{
                    "28", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
                     ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], " ", 
                   SuperscriptBox["r", "4"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"24", " ", "\[ImaginaryI]", " ", 
                    SuperscriptBox["M", "3"], " ", "\[Omega]"}], "+", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["M", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m", "2"]}], 
                    "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
                    RowBox[{
                    "5", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "r", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", "\[Omega]"}], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "-", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["m", "2"]}], "-", 
                    RowBox[{
                    "5", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
                    
                    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "-", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["m", "2"]}], "+", 
                    RowBox[{
                    "4", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{"10", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], 
                    "+", 
                    RowBox[{"M", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    
                    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["m", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "9"}], 
                    "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "+", 
                    RowBox[{
                    "21", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
                     ")"}]}], "-", 
                    RowBox[{
                    "2", " ", "r", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", "\[Omega]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"9", " ", "\[ImaginaryI]"}], "+", 
                    RowBox[{"14", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
                    RowBox[{"6", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
                    RowBox[{"18", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "+", 
                    RowBox[{"6", " ", "\[ImaginaryI]", " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["\[Omega]", "3"]}]}], ")"}]}]}], ")"}]}]}],
                     ")"}]}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["a", "4"], " ", 
                   SuperscriptBox["r", "3"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    SuperscriptBox["M", "2"], " ", "\[Omega]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "5"}], " ", "\[ImaginaryI]"}], "+", 
                    RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
                    
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "9"}], 
                    "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
                    
                    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "-", 
                    RowBox[{
                    "12", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{
                    "12", " ", "\[ImaginaryI]", " ", "r", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", "\[Omega]"}], "-", 
                    RowBox[{"21", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["r", "2"], 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "-", 
                    RowBox[{"24", " ", "\[ImaginaryI]", " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["\[Omega]", "3"]}], "+", 
                    RowBox[{
                    SuperscriptBox["m", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "27", "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "-", 
                    RowBox[{
                    "12", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}],
                     ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"M", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "24"}], " ", 
                    SuperscriptBox["m", "2"]}], "+", 
                    RowBox[{
                    "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "-", 
                    RowBox[{
                    "11", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"6", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "+", 
                    RowBox[{
                    "8", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "+", 
                    RowBox[{"7", " ", "\[ImaginaryI]", " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["\[Omega]", "3"]}]}], ")"}]}]}], ")"}]}]}],
                     ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["a", "6"], " ", "r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "6"}], " ", "M", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{
                    "5", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{"8", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    SuperscriptBox["m", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "+", 
                    
                    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", " ", 
                    RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"14", " ", "\[ImaginaryI]", " ", "r", " ", 
                    "\[Omega]"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"6", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "-", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}], "-", 
                    RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["\[Omega]", "3"]}]}], ")"}]}]}], ")"}]}]}],
                     ")"}]}]}], ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["a", "2"], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}]}]}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["r", "4"]}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                    
                    SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "-", 
                    RowBox[{
                    "12", " ", "\[ImaginaryI]", " ", "M", " ", "\[Omega]"}]}],
                     ")"}]}], "+", 
                  RowBox[{"24", " ", 
                   SuperscriptBox["a", "3"], " ", "m", " ", "r", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[ImaginaryI]", "-", 
                    RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
                  
                  RowBox[{"12", " ", 
                   SuperscriptBox["a", "4"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "-", 
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                    "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "-", 
                  RowBox[{"4", " ", "a", " ", "m", " ", 
                   SuperscriptBox["r", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", "\[ImaginaryI]", " ", "M"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "2", " ", "\[ImaginaryI]", 
                    " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                    RowBox[{"3", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["a", "2"], " ", "r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"M", " ", 
                    RowBox[{"(", 
                    RowBox[{"6", "+", 
                    RowBox[{
                    "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["m", "2"]}], "+", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], 
                    "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\
\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}],
                  ")"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"X\\\\\\\"\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\", \\\"\\\\\\\"SN\\\\\\\"\\\"], \\\"Subsuperscript\\\
\", Rule[SyntaxForm, SubsuperscriptBox]]\\)\"\>", "[", "r", "]"}]}]}]}], "-", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"M", "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "+", 
            SuperscriptBox["M", "2"]}]], "-", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M"}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "+", 
            SuperscriptBox["M", "2"]}]], "+", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", " ", 
           SuperscriptBox["r", "7"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], 
              " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "-", 
             
             SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "+", 
             RowBox[{
             "12", " ", "\[ImaginaryI]", " ", "M", " ", "\[Omega]"}]}], 
            ")"}]}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["a", "7"], " ", "m", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "\[ImaginaryI]"}], "-", 
             RowBox[{"4", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
          RowBox[{"12", " ", 
           SuperscriptBox["a", "8"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "-", 
             RowBox[{"3", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
             "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", 
           SuperscriptBox["a", "3"], " ", "m", " ", 
           SuperscriptBox["r", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"18", " ", 
              SuperscriptBox["M", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["r", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"9", "-", 
                RowBox[{
                "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                RowBox[{
                "12", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
               ")"}]}], "+", 
             RowBox[{"M", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "24"}], "+", 
                RowBox[{
                "4", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "-", 
                RowBox[{
                "15", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
               ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "a", " ", "m", " ", 
           SuperscriptBox["r", "5"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              SuperscriptBox["M", "2"]}], "-", 
             RowBox[{
              SuperscriptBox["r", "2"], 
              " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
             RowBox[{"3", " ", "\[ImaginaryI]", " ", "M", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[ImaginaryI]"}], "+", 
                RowBox[{"r", " ", "\[Omega]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["a", "5"], " ", "m", " ", 
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"18", " ", "\[ImaginaryI]"}], "-", 
                RowBox[{
                "\[ImaginaryI]", 
                 " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "-", 
                RowBox[{"24", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
             RowBox[{"6", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "5"}], " ", "\[ImaginaryI]"}], "+", 
                RowBox[{"6", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], 
            ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["M", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "24"}], "-", 
                RowBox[{
                "18", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
               ")"}]}], "+", 
             RowBox[{"M", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{"36", "-", 
                RowBox[{"18", " ", 
                 SuperscriptBox["m", "2"]}], "-", 
                RowBox[{"4", " ", "\[ImaginaryI]", " ", "r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "9"}], 
                   "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}], "-", 
                RowBox[{"9", " ", 
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["r", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "12"}], "+", 
                RowBox[{"12", " ", 
                 SuperscriptBox["m", "2"]}], "+", 
                RowBox[{"\[ImaginaryI]", " ", "r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "15"}], "+", 
                   RowBox[{
                   "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\
\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}]}], ")"}], " ", "\[Omega]"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["a", "6"], " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "6"}], " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "4"}], "-", 
                RowBox[{
                "5", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "15"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["m", "2"]}], "+", 
                RowBox[{"\[ImaginaryI]", " ", "r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "21"}], 
                   "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}], "+", 
                RowBox[{"12", " ", 
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["r", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["M", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "48"}], "-", 
                RowBox[{
                "36", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
               ")"}]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["r", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["m", "2"]}], "+", 
                RowBox[{"\[ImaginaryI]", " ", "r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}]}], ")"}]}], 
             "+", 
             RowBox[{"M", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "24"}], " ", 
                 SuperscriptBox["m", "2"]}], "+", 
                RowBox[{
                "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                
                SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "+", 
                RowBox[{"12", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "+", 
                   RowBox[{
                   "2", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
                   "+", 
                   RowBox[{
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}],
             ")"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"X\\\\\\\"\\\
\", \\\"\\\\\\\"-2\\\\\\\"\\\", \\\"\\\\\\\"SN\\\\\\\"\\\"], \
\\\"Subsuperscript\\\", Rule[SyntaxForm, SubsuperscriptBox]]\\)\"\>", 
          "\[Prime]",
          MultilineFunction->None], "[", "r", "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"r", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["r", "2"]}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"\\\\\
\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
             
             SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>", "2"], "-", 
             RowBox[{
             "12", " ", "\[ImaginaryI]", " ", "M", " ", "\[Omega]"}]}], 
            ")"}]}], "+", 
          RowBox[{"24", " ", 
           SuperscriptBox["a", "3"], " ", "m", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "+", 
             RowBox[{"2", " ", "r", " ", "\[Omega]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "4"], " ", 
           RowBox[{"(", 
            RowBox[{"12", "+", 
             RowBox[{"24", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}], 
             "-", 
             RowBox[{"24", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "a", " ", "m", " ", 
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", "\[ImaginaryI]", " ", "M"}], "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "2", " ", "\[ImaginaryI]", 
                 " ", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], "+", 
                RowBox[{"3", " ", "r", " ", "\[Omega]"}]}], ")"}]}]}], 
            ")"}]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["a", "2"], " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"M", " ", 
              RowBox[{"(", 
               RowBox[{"6", "+", 
                RowBox[{
                "6", " ", "\[ImaginaryI]", " ", "r", " ", "\[Omega]"}]}], 
               ")"}]}], "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"6", " ", 
                 SuperscriptBox["m", "2"]}], "+", 
                RowBox[{"2", " ", "\[ImaginaryI]", " ", "r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], 
                   "+", "\<\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \
\\\"\\\\\\\"-2\\\\\\\"\\\"]\\)\"\>"}], ")"}], " ", "\[Omega]"}], "+", 
                RowBox[{"3", " ", 
                 SuperscriptBox["r", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellLabel->
  "Out[39]=",ExpressionUUID->"75698b74-4d5f-4f8c-ad0f-db6c3c9127a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellFrameLabels->{{
    FEPrivate`If[
     FEPrivate`Or[
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "6.0"], 
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "7.0"], 
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "8.0"]], 
     Cell[
      TextData[
       ButtonBox[
       "RELATED TUTORIALS", BaseStyle -> None, 
        Appearance -> {Automatic, None}, Evaluator -> None, Method -> 
        "Preemptive", ButtonFunction :> (FrontEndExecute[{
           FrontEnd`SelectionMove[
            FrontEnd`SelectedNotebook[], All, ButtonCell], 
           FrontEndToken["OpenCloseGroup"], 
           FrontEnd`SelectionMove[
            FrontEnd`SelectedNotebook[], After, CellContents]}]& )]], 
      "RelatedTutorialsSection"], 
     TextData[
      ButtonBox[
       Cell[
        TextData[{
          Cell[
           BoxData[
            TemplateBox[{24}, "Spacer1"]]], "Related Tutorials"}], 
        "RelatedTutorialsSection"], BaseStyle -> None, 
       Appearance -> {Automatic, None}, Evaluator -> None, Method -> 
       "Preemptive", ButtonFunction :> (FrontEndExecute[{
          FrontEnd`SelectionMove[
           FrontEnd`SelectedNotebook[], All, ButtonCell], 
          FrontEndToken["OpenCloseGroup"], 
          FrontEnd`SelectionMove[
           FrontEnd`SelectedNotebook[], After, CellContents]}]& )]]], None}, {
   None, None}},
 CellFrameLabelMargins->
  0,ExpressionUUID->"f13bfb56-e896-4667-a1ce-0ba387c1691b"],

Cell[TextData[ButtonBox["Field equations on Schwarzschild",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Field equations on Schwarzschild"]], \
"RelatedTutorials",ExpressionUUID->"dd86f4b1-285d-46b6-af34-4fd37f9e5c0a"],

Cell[TextData[ButtonBox["Time domain amplitudes",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Time domain amplitudes"]], \
"RelatedTutorials",ExpressionUUID->"c7864e26-2710-4a90-8391-06cd96627d74"],

Cell[TextData[ButtonBox["Equations of motion",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Equations of motion"]], \
"RelatedTutorials",ExpressionUUID->"89823727-d278-4388-bc95-7f6c5b44fed1"],

Cell[TextData[ButtonBox["Weak functions",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Weak functions"]], \
"RelatedTutorials",ExpressionUUID->"d1a5e6fe-4406-4346-b844-476bbe2cffac"],

Cell[TextData[ButtonBox["Source terms",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Source terms"]], \
"RelatedTutorials",ExpressionUUID->"624807d2-9d6f-410f-a547-2fdb1ea5701a"],

Cell[TextData[ButtonBox["Using labels to act on groups of variables",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Using labels to act on groups of \
variables"]], \
"RelatedTutorials",ExpressionUUID->"1a92e244-c382-4b7c-a792-07a073c977d2"],

Cell[TextData[ButtonBox["Examples",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Examples"]], \
"RelatedTutorials",ExpressionUUID->"4b41393a-edbb-4d9c-9220-6d0e561a9788"]
}, Open  ]]
}, Open  ]],

Cell[" ", \
"FooterCell",ExpressionUUID->"32002b42-8fe7-44af-b9ca-48eb2818fca4"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Manipulating and simplifying large expressions",
Visible->True,
PrivateNotebookOptions->{"FileOutlineCache"->False},
TaggingRules->{
 "ModificationHighlight" -> False, 
  "Metadata" -> {
   "context" -> "BlackHoleAnalysis`", 
    "keywords" -> {"Simplify", "Reduce", "Expressions"}, "index" -> True, 
    "label" -> "Simplifying expressions", "language" -> "en", "paclet" -> 
    "Simplifying expressions", "status" -> "None", "summary" -> 
    "Simplifying expressions", "synonyms" -> {}, "title" -> 
    "Manipulating and simplifying large expressions", "windowTitle" -> 
    "Manipulating and simplifying large expressions", "type" -> "Tutorial", 
    "uri" -> "BlackHoleAnalysis/tutorial/Manipulating and simplifying large \
expressions", "WorkflowDockedCell" -> ""}, "SearchTextTranslated" -> "", 
  "LinkTrails" -> ""},
TrackCellChangeTimes->False,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Reference.nb", 
  CharacterEncoding -> "UTF-8"]
]

