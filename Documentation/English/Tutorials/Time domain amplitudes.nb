Notebook[{
Cell[" ", "TutorialColorBar",
 CellMargins->{{Inherited, Inherited}, {-5, 
   0}},ExpressionUUID->"4b57f3a5-e7c2-4c1f-8ab2-b354b292d1c1"],

Cell[TextData[{
 ButtonBox["BlackHoleAnalysis",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->"paclet:BlackHoleAnalysis/guide/BlackHoleAnalysis"],
 StyleBox[" > ", "LinkTrailSeparator"],
 ButtonBox["Time domain amplitudes",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->"paclet:BlackHoleAnalysis/tutorial/Time domain amplitudes"]
}], "LinkTrail",ExpressionUUID->"fa49cb9d-c07b-4875-8580-e6be42132ccb"],

Cell[BoxData[GridBox[{
   {Cell["TIME DOMAIN AMPLITUDES TUTORIAL", "PacletNameCell",ExpressionUUID->
     "0d6cab0f-9715-4b5c-a70d-b4190fa1a394"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"Related Tutorials \[RightGuillemet]\"\>",
        StripOnInput->False], {
       RowBox[{"Field", " ", "equations", " ", "on", " ", "Schwarzschild"}]:>
       Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Field equations on Schwarzschild"], 
       "Conventions":>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Conventions"], 
       RowBox[{
       "Using", " ", "labels", " ", "to", " ", "act", " ", "on", " ", 
        "groups", " ", "of", " ", "variables"}]:>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Using labels to act on groups of \
variables"], 
       RowBox[{"Weak", " ", "functions"}]:>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Weak functions"], "Discontinuities":>
       Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Discontinuities"], "Examples":>
       Documentation`HelpLookup["paclet:BlackHoleAnalysis/tutorial/Examples"]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "5dcb8bb2-0fb7-4063-afc2-00af8f21ae91"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"URL \[RightGuillemet]\"\>",
        StripOnInput->False], {"\<\"Go to BlackHoleAnalysis website\"\>":>
       FrontEndExecute[{
         NotebookLocate[{
           URL[None], None}]}], 
       Delimiter, "\<\"Go to wolfram Mathematica website\"\>":>
       FrontEndExecute[{
         NotebookLocate[{
           URL[
           "http://reference.wolfram.com/mathematica/guide/Mathematica.html"],
            None}]}]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "716dbb3b-1df3-420c-847c-b02e746b16da"]
    }], "AnchorBar",ExpressionUUID->"dd2b64f5-8a99-4d69-96ca-515149c60f21"]}
  }]], "AnchorBarGrid",ExpressionUUID->"efac8b94-a1d7-4fa4-aa88-af1936a91a01"],

Cell[CellGroupData[{

Cell["BlackHoleAnalysis - Time domain amplitudes on Schwarzschild", \
"Title",ExpressionUUID->"9bc50914-8ceb-465c-9e0b-d89de9aea77c"],

Cell[BoxData[
 RowBox[{"<<", "BlackHoleAnalysis`"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"d24789bf-0507-4070-a0f8-0be45c35e1d7"],

Cell[CellGroupData[{

Cell["Metric perturbation amplitudes", \
"Section",ExpressionUUID->"9f9f0d43-678b-4b6f-b787-54b3bb1d1c70"],

Cell["\<\
BlackHoleAnalysis provides expressions for many scalar amplitudes that exist \
on a Schwarzschild background.\
\>", "Item",ExpressionUUID->"31755c2e-aaaa-44f2-adc4-97c4c4154cb2"],

Cell["\<\
For instance, here is the metric perturbation amplitudes \
\[ScriptCapitalK][t,r]\
\>", "Item",ExpressionUUID->"4c24cdb2-38d2-415f-b642-228ae4495bec"],

Cell[CellGroupData[{

Cell["Formatted output of amplitudes", \
"Subsection",ExpressionUUID->"88ee9bd7-30f3-4cea-8834-0080c24d2e15"],

Cell[CellGroupData[{

Cell["\<\
By default it has a tag \[OpenCurlyDoubleQuote]RWZ\[CloseCurlyDoubleQuote] to \
indicate that it is a Regge-Wheeler-Zerilli-gauge amplitude.\
\>", "Item",ExpressionUUID->"5a3ce094-934c-43d4-abf6-94187bf74cc7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", "]"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"0afc9e13-5581-4ef1-9cb5-20fdcafe93e7"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->"Out[2]=",ExpressionUUID->"65c7bba7-d238-45af-8cf2-f97d76f3c358"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric reconstruction from master functions", \
"Subsection",ExpressionUUID->"e76dfeb1-4580-4145-921a-70d892f4d31c"],

Cell[CellGroupData[{

Cell["\<\
In this gauge, \[ScriptCapitalK] can be written in terms of the Zerilli \
master function.\
\>", "Item",ExpressionUUID->"57b39525-8246-49e0-80e2-b0f16aab3f1b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Reconstruct", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"a3045fe3-46e7-4174-ab6d-6955ceda6458"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"24", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", "l", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}], "+", 
         SuperscriptBox["l", "3"]}], ")"}], " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"Q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->"Out[3]=",ExpressionUUID->"7bf533dd-8b3a-44f6-a5db-842a57f2a73b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Changing gauges", \
"Subsection",ExpressionUUID->"efc5a2fa-7928-42ca-a846-e661d50413e6"],

Cell[CellGroupData[{

Cell["Instead, we may wish to write this in Lorenz gauge", \
"Item",ExpressionUUID->"7675a3fb-d629-4f3d-a45f-b954d8e23337"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], "]"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"0b755f57-dcd8-4cde-a492-dbed7fd629bd"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->"Out[4]=",ExpressionUUID->"4628a0a5-9028-46f0-9ac0-0734336067e4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Now, there is no reconstruction possible.", \
"Item",ExpressionUUID->"f1645a1a-8f94-4a9e-b79d-626adb281d7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"Reconstruct", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"174688fe-cbf4-4050-b105-abb60afc5dc8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"MP amplitude \"\>", 
   "\[InvisibleSpace]", \
"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*RowBox[{\
\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", 
   "\[InvisibleSpace]", "\<\" cannot be reconstructed from master function in \
\"\>", "\[InvisibleSpace]", "\<\"Lorenz\"\>", 
   "\[InvisibleSpace]", "\<\" gauge.\"\>"}],
  SequenceForm["MP amplitude ", 
   $CellContext`\[ScriptCapitalK]["Tags" -> {"Up" -> {"LorenzTag"}}], 
   " cannot be reconstructed from master function in ", "Lorenz", " gauge."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"52fede64-42b5-43ef-919f-6bcd146ddcc2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Set Option PushFrom->\\\"RWZ\\\" to reconstruct the amplitude \
in RWZ gauge and transform it to \"\>", "\[InvisibleSpace]", "\<\"Lorenz\"\>",
    "\[InvisibleSpace]", "\<\" gauge.\"\>"}],
  SequenceForm[
  "Set Option PushFrom->\"RWZ\" to reconstruct the amplitude in RWZ gauge and \
transform it to ", "Lorenz", " gauge."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"71374bb8-6134-451d-91cf-71915d45b940"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Aborting in \"\>", "\[InvisibleSpace]", 
   "BlackHoleAnalysis`Fields`Private`getMPAmplitude", 
   "\[InvisibleSpace]", "\<\"[].\"\>"}],
  SequenceForm[
  "Aborting in ", BlackHoleAnalysis`Fields`Private`getMPAmplitude, "[]."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"c47b08f3-6518-4cbb-887b-3076c863f7fd"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->"Out[5]=",ExpressionUUID->"3c7db982-dc05-45e4-978a-74647542fcbe"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
However, there is the possibility to write \[ScriptCapitalK] as a Lorenz \
gauge amplitude that has been pushed from RWZ gauge\
\>", "Item",ExpressionUUID->"476a31f8-4dad-40e8-a3f6-e22c45d6f34c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"PushFrom", "\[Rule]", "\"\<RWZ\>\""}]}], "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"a8fd958b-93ab-4671-bd36-a5845c7c3bde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
   RowBox[{"t", ",", "r"}], "]"}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], "r"]}]], "Output",
 CellLabel->"Out[6]=",ExpressionUUID->"9826d2ca-4d0b-4f0d-ba0c-10217dc65b5d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Now, reconstruction is possible.", \
"Item",ExpressionUUID->"1bfdd340-a865-45d4-8603-d8e8fc3a831b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"PushFrom", "\[Rule]", "\"\<RWZ\>\""}], ",", 
   RowBox[{"Reconstruct", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"7be95c69-10e4-4e23-97f0-bf0aa61995c3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"24", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", "l", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}], "+", 
         SuperscriptBox["l", "3"]}], ")"}], " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"Q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], "r"]}]], "Output",
 CellLabel->"Out[7]=",ExpressionUUID->"6c5c5ae2-9030-49d3-9daa-286a6d4e0fe8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gauge invariant amplitudes", "Subsection",
 CellChangeTimes->{{3.741350078909013*^9, 
  3.7413500837291517`*^9}},ExpressionUUID->"f6f1de93-dac1-47c9-9075-\
3a3788ba8678"],

Cell[TextData[{
 "Martel & Poisson (",
 ButtonBox["arxiv.org/abs/gr-qc/0502028",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/gr-qc/0502028"], None},
  ButtonNote->"https://arxiv.org/abs/gr-qc/0502028"],
 ") give 6 gauge invariant amplitudes."
}], "Item",
 CellChangeTimes->{{3.741350101486623*^9, 
  3.741350124011023*^9}},ExpressionUUID->"635fd178-9947-427e-8947-\
ff6213ab4e40"],

Cell[CellGroupData[{

Cell["They are equal to the RWZ gauge amplitudes.", "Item",
 CellChangeTimes->{{3.741350101486623*^9, 
  3.741350131636654*^9}},ExpressionUUID->"1c82e984-fa4d-4793-8f13-\
586075f326f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "HttInvariantAmplitude"}]], "Input",
 CellChangeTimes->{{3.741350145660314*^9, 3.741350145958117*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f37fe562-70d3-4a01-b9fc-8f95e4e3f4af"],

Cell[BoxData[
 RowBox[{"\<\"HttInvariantAmplitude[] returns the gauge-invariant metric \
perturbation amplitude h_tt in symbolic form.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/HttInvariantAmplitude"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info83741463207-7756260",ExpressionUUID->"8c558fec-124f-4777-8f01-\
43dfb544b90f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttInvariantAmplitude", "[", "]"}]], "Input",
 CellChangeTimes->{{3.74135013869496*^9, 3.74135014115154*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"96e14a85-de86-4994-a222-18f3b1f61056"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\\\\\
\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"tt\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"20a7ec9b-67d0-4e12-8fe7-87a668523346"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["In another gauge there are more terms", "Item",
 CellChangeTimes->{{3.741350164908155*^9, 
  3.741350182337193*^9}},ExpressionUUID->"b4f76f8b-70f8-40f5-b655-\
48257873916b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttInvariantAmplitude", "[", 
  RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.741350153971806*^9, 3.74135015720079*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"edf8d188-4dc2-46cf-9717-1454feba2807"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "M"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\
\\\\(\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"t\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\\\
\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"tt\\\\\\\\\\\\\\\
\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
   RowBox[{"t", ",", "r"}], "]"}], "+", 
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellLabel->
  "Out[10]=",ExpressionUUID->"16be40fd-dd52-4306-b1ba-591b46babeed"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Low-order modes", "Subsection",
 CellChangeTimes->{{3.741350316371502*^9, 
  3.741350319392022*^9}},ExpressionUUID->"616e4465-d22f-49bf-81f2-\
9bb3d0055e8d"],

Cell["Some low order modes are known exactly.", "Item",
 CellChangeTimes->{{3.7413503247039967`*^9, 
  3.74135033367857*^9}},ExpressionUUID->"3c418ebb-ecd8-41de-82a2-\
4a5251841a75"],

Cell[CellGroupData[{

Cell["Zerilli\[CloseCurlyQuote]s solutions are built-in.", "Item",
 CellChangeTimes->{{3.7413503247039967`*^9, 
  3.741350339315797*^9}},ExpressionUUID->"f15ada7e-aaf2-4ca0-8c18-\
558c6c2482eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttAmplitude", "[", 
  RowBox[{
   RowBox[{"Mode", "\[Rule]", "\"\<Monopole\>\""}], ",", 
   RowBox[{"ExpandZerilli", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7413503413067093`*^9, 3.741350360893955*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"56709096-3493-4e60-9de2-caecaa5e792a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    SqrtBox["\[Pi]"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], "r"], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SqrtBox["\[Pi]"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["\[ScriptCapitalE]", "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox["\[ScriptCapitalL]", "2"], 
          SuperscriptBox[
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"2", " ", "M"}], 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{"\[ScriptCapitalE]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]]}]], "Output",
 CellLabel->
  "Out[11]=",ExpressionUUID->"0b777e32-d729-4cd2-9e4d-7c870f579095"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttAmplitude", "[", 
  RowBox[{
   RowBox[{"Mode", "\[Rule]", "\"\<Dipole\>\""}], ",", 
   RowBox[{"ExpandZerilli", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.741350372506981*^9, 3.7413503737298517`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"65d35247-27a9-4289-93d9-3486dde1c237"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}]], 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Phi]\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]], " ", 
    SqrtBox[
     FractionBox[
      RowBox[{"2", " ", "\[Pi]"}], "3"]], " ", "r", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
       SuperscriptBox["r", "3"]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], 
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ScriptCapitalE]", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"6", " ", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{
           "\[ImaginaryI]", " ", "\[ScriptCapitalE]", " ", 
            "\[ScriptCapitalL]", " ", 
            RowBox[{
             
             SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
       RowBox[{"\[ScriptCapitalE]", " ", 
        SuperscriptBox[
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "4"]}]]}], 
     ")"}]}]}]}]], "Output",
 CellLabel->
  "Out[12]=",ExpressionUUID->"d8b29ea9-2563-4a2d-83a2-d1c0c4468c2c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Source term expansion", \
"Subsection",ExpressionUUID->"5be67252-53e3-4e6f-a2d3-cd44ffc97fd6"],

Cell["\<\
When reconstructing MP amplitudes from the master functions, singular source \
terms appear.\
\>", "Item",ExpressionUUID->"9573c386-aca2-405a-a578-03bc86db6484"],

Cell["We can expand those terms in various ways.", \
"Item",ExpressionUUID->"0f3b8809-ce2a-43df-b98e-bba85ab094b1"],

Cell[CellGroupData[{

Cell[TextData[{
 "SourceExpansion \[Rule] \[OpenCurlyDoubleQuote]Partial\
\[CloseCurlyDoubleQuote] shows Dirac delta functions explicitly, but hides \
the rest of the source, as in Hopper & Evans (",
 ButtonBox["arxiv.org/abs/1006.4907",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/1006.4907"], None},
  ButtonNote->"https://arxiv.org/abs/1006.4907"],
 ")."
}], "Item",ExpressionUUID->"d62afbb3-2a1c-4b1d-9f8a-c2b132f0432d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
   RowBox[{"SourceExpansion", "\[Rule]", "\"\<Partial\>\""}]}], 
  "]"}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"5a3ee0d6-0acc-4226-a3bc-9ab9fb8930aa"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"24", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", "l", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}], "+", 
         SuperscriptBox["l", "3"]}], ")"}], " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", "t", 
     "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[13]=",ExpressionUUID->"dc77b27f-2141-414d-93f2-c20bc888decc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SourceExpansion \[Rule] \[OpenCurlyDoubleQuote]Full\
\[CloseCurlyDoubleQuote] shows the full source terms.", \
"Item",ExpressionUUID->"b9237d9c-fe8a-41b9-9577-4bd5722eb25e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
   RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], "]"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"ce62362b-551e-42ee-8506-9975bb225df8"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"24", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", "l", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}], "+", 
         SuperscriptBox["l", "3"]}], ")"}], " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"32", " ", "\[Pi]", " ", 
    SuperscriptBox["r", "3"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}], "3"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[14]=",ExpressionUUID->"d70e4020-02a3-43db-b9ed-a146304f75b0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Note that we can drop these singular terms with RemoveSingular.\
\>", "Item",ExpressionUUID->"7f784ef9-de4d-45e2-a183-b52823c9685c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveSingular"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"3e3d487b-1cc4-46d8-9dc7-2e53c436e288"],

Cell[BoxData[
 RowBox[{"\<\"RemoveSingular[expr] removes all terms in expr not proportional \
to Heaviside functions (this includes derivatives of Heavisides).\"\>", 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveSingular"]}]], "Print", "PrintUsage",
 CellTags->
  "Info153741463208-7756260",ExpressionUUID->"29d95f09-0b16-49dd-bbf5-\
e8744b1fdc2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveSingular", "[", 
  RowBox[{"KAmplitude", "[", 
   RowBox[{
    RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
    RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], "]"}], 
  "]"}]], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"4198efef-caec-4cb0-88ac-397fa807fb55"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"24", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", "l", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}], "+", 
         SuperscriptBox["l", "3"]}], ")"}], " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[16]=",ExpressionUUID->"f3e90387-36ed-40dd-af97-85c8e8d3f1f4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak fields", \
"Subsection",ExpressionUUID->"b9681739-8316-48e3-9436-d99b9bc04439"],

Cell[TextData[{
 "It is often useful to consider amplitudes in a weak form, such as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", "(", 
     RowBox[{"t", ",", "r"}], ")"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", "+"], "(", 
       RowBox[{"t", ",", "r"}], ")"}], " ", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{"r", "-", 
        SubscriptBox["r", "p"]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", "-"], "(", 
       RowBox[{"t", ",", "r"}], ")"}], " ", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{
        SubscriptBox["r", "p"], "-", "r"}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"3395ce7f-10e8-4ee6-9b7e-d49e91574f45"],
 "."
}], "Item",ExpressionUUID->"2a7256be-b019-4fe3-b3d6-974e5bab1179"],

Cell["\<\
This functionality is built into BlackHoleAnalysis at a fundamental level.\
\>", "Item",ExpressionUUID->"caed070f-2646-44d7-9db6-a56182fda195"],

Cell[CellGroupData[{

Cell[TextData[{
 "For instance, one can use the function MakeFieldWeak, which assumes a ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "383bb1a6-c078-4f6b-a670-9613dbbeea72"],
 " form."
}], "Item",ExpressionUUID->"8d11c4bb-711f-4789-94bb-81124d43cd47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MakeFieldWeak"}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"5e5059c2-2231-4859-93ae-ac56bd9bd3b4"],

Cell[BoxData[
 RowBox[{"\<\"MakeFieldWeak[field] replaces the smooth field with a weak \
expression that is (by default) C^-1.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/MakeFieldWeak"]}]], "Print", "PrintUsage",
 CellTags->
  "Info173741463208-7756260",ExpressionUUID->"29c5f4f9-5dff-45d6-8b85-\
aeee4c995323"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeFieldWeak", "[", 
  RowBox[{"KAmplitude", "[", "]"}], "]"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"f7ccafe0-8c7c-4c6a-93f0-773bc45b1a05"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[18]=",ExpressionUUID->"8551664a-d496-4e58-bc95-b0f170e166be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["It is easier to use options:", \
"Item",ExpressionUUID->"4332be3f-fd2e-4e0c-9f1a-3e88f0a8d35c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Weak", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"77254146-1336-4f9c-b76a-17053bdefc6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[19]=",ExpressionUUID->"0b0cfbfc-6784-4f8f-9135-f66adde6458f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KWeak", "=", 
  RowBox[{"KAmplitude", "[", 
   RowBox[{
    RowBox[{"Weak", "\[Rule]", "True"}], ",", 
    RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
    RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"57287006-7ce0-4142-bdf5-380ffb690d8f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"24", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", "l", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}], "+", 
         SuperscriptBox["l", "3"]}], ")"}], " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"24", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", "l", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["l", "2"]}], "+", 
         SuperscriptBox["l", "3"]}], ")"}], " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"32", " ", "\[Pi]", " ", 
    SuperscriptBox["r", "3"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}], "3"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[20]=",ExpressionUUID->"672aa7ac-132d-44f9-9a43-e28e741bd9ec"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "There are terms in this expression like ",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{"r", "-", 
     RowBox[{
      SubscriptBox["r", "p"], "[", "t", "]"}]}], "]"}]}]],ExpressionUUID->
  "0b19f075-828d-4576-a893-8f8205adb7ee"],
 ", which we can rewrite at ",
 Cell[BoxData[
  RowBox[{"\[Delta]", "[", 
   RowBox[{"r", "-", 
    RowBox[{
     SubscriptBox["r", "p"], "[", "t", "]"}]}], "]"}]],ExpressionUUID->
  "eb99b782-b8e8-4aee-ab99-cd229b9529f3"],
 " using EvaluateDiscontinuities."
}], "Item",ExpressionUUID->"ebebf08e-87cc-4602-bec2-5ad99f491ca6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluating jumps", \
"Subsection",ExpressionUUID->"54231fcf-df3a-4806-a004-0ef5661e0807"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "EvaluateDiscontinuities"}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"bf7e1077-cacd-4fd1-9d58-ac7c1d5af878"],

Cell[BoxData[
 RowBox[{"\<\"EvaluateDiscontinuities[expr] calls EvaluateHeavisides, \
EvaluateDeltas and EvaluateJumps on expr.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/EvaluateDiscontinuities"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info213741463208-7756260",ExpressionUUID->"6b4bae94-69bb-49bf-8c6b-\
31867ba7354c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KWeakEval", "=", 
  RowBox[{"EvaluateDiscontinuities", "[", "KWeak", "]"}]}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"93421670-e62f-4c12-8b47-00a65146a616"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"24", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "-", "l", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["l", "2"]}], "+", 
            SuperscriptBox["l", "3"]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"24", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "-", "l", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["l", "2"]}], "+", 
            SuperscriptBox["l", "3"]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"32", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
      RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*RowBox[{\\\"\\\\\\\"\\\\\\\\!\
\\\\\\\\(\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"], \\\\\\\\\\\\\\\"Superscript\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\\\\\\\)\\\\\\\"\\\"}]\\)\
\[RightDoubleBracket]\"\>", "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellLabel->
  "Out[22]=",ExpressionUUID->"0c7c5260-e948-4794-88db-a901f4455a27"]
}, Open  ]],

Cell[TextData[{
 "The term ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[LeftDoubleBracket]", 
    SuperscriptBox["\[CapitalPsi]", "ZM"], "\[RightDoubleBracket]"}], "[", 
   "t", "]"}]],ExpressionUUID->"a2d2a696-83a0-4591-8dc4-a5b11f4928c9"],
 " is the time-dependent jump in the ZM master function."
}], "Item",ExpressionUUID->"28954872-7db2-4e82-b257-4cbbc6393055"],

Cell[CellGroupData[{

Cell["\<\
This, too is built in with the function MasterFunctionDiscontinuities.\
\>", "Item",ExpressionUUID->"f0c1ee73-ae0e-4ba8-a742-cbe7eb3646f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MasterFunctionDiscontinuities"}]], "Input",
 CellChangeTimes->{3.741284259289548*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"f3d49a93-b074-44bb-a552-d8ec351d6dd5"],

Cell[BoxData[
 RowBox[{"\<\"MasterFunctionDiscontinuities[] returns an Association with \
discontinuities in the master function and its first three r \
derivatives.\\nMasterFunctionDiscontinuities[{m,n}] returns an Association \
with discontinuities in the m-th time derivative and n-th r derivative of the \
master function.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/MasterFunctionDiscontinuities"]}]], \
"Print", "PrintUsage",
 CellTags->
  "Info233741463208-7756260",ExpressionUUID->"88dafcd7-ba23-42e0-9df0-\
9220b3165e27"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "There are built-in discontinuities through the third derivative of ",
 Cell[BoxData[
  SuperscriptBox["\[CapitalPsi]", "ZM"]],ExpressionUUID->
  "a35e69c8-327e-4dc3-8be7-7432edcc2966"],
 "."
}], "Item",ExpressionUUID->"b22fc8a7-b114-4863-a774-c6aace233cea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MasterFunctionDiscontinuities", "[", "]"}], "//", 
  "Keys"}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"dd9293d1-e844-449d-9b0e-938a834cb84e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\
\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(r\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubsuperscriptBox[\\(\[PartialD]\
\\), \\(r\\), \\(2\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubsuperscriptBox[\\(\[PartialD]\
\\), \\(r\\), \\(3\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[24]=",ExpressionUUID->"a8b7b51d-7767-43e6-8da5-918178468c69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jumps", "=", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"MasterFunctionDiscontinuities", "[", "]"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"0e5412ed-5254-4f15-85af-0d827f2ce87a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], " ", 
      RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \
\\\"\\\\\\\"_\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "M"}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "l"}], ")"}], " ", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}]}]]}], ",", 
   RowBox[{
    RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(r\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", 
           SuperscriptBox["M", "2"]}], "+", 
          RowBox[{
           FractionBox["3", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "l"}], ")"}], " ", "M", " ", 
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "l"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox[
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \
\\\"\\\\\\\"_\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "M"}], "-", 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "M"}], "+", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "l"}], ")"}], " ", 
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}], "2"]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"16", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", 
       SuperscriptBox["\[ScriptCapitalL]", "2"], " ", "\[Mu]", " ", 
       RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"Y\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\[Phi]\
\\\"], DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalL]", "2"], "+", 
         SuperscriptBox[
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}], "2"]}], ")"}]}]]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellLabel->
  "Out[25]=",ExpressionUUID->"93524823-499e-4bf5-94d2-0b689a67872f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Using this, we see that the Dirac delta term vanishes and  \
\[ScriptCapitalK] is actually ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "20ce00a8-5a09-49b5-acf3-35b865857091"],
 "."
}], "Item",ExpressionUUID->"743d9260-1c71-4672-9a57-183b5683c570"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"KWeakEval", "/.", "jumps"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"r", "-", 
     RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"f789d47e-8153-4011-bc8e-dd16ee3129d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"24", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "-", "l", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["l", "2"]}], "+", 
            SuperscriptBox["l", "3"]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"24", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "M", " ", "r"}], "+", 
         RowBox[{"l", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "-", "l", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["l", "2"]}], "+", 
            SuperscriptBox["l", "3"]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellLabel->
  "Out[26]=",ExpressionUUID->"1f6e1751-4c99-4cca-a27d-f4e3109ef2af"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Master functions", \
"Section",ExpressionUUID->"382f55a3-a06e-4391-8df7-885a292c5efa"],

Cell["\<\
The CPM & ZM master functions behave in much the same way as the MP amplitudes\
\>", "Item",ExpressionUUID->"9b9b2123-9fe6-47d9-8511-7a222c950949"],

Cell["By default the parity is even.", \
"Item",ExpressionUUID->"1b56526d-0b00-4539-a776-3aa87736604d"],

Cell[CellGroupData[{

Cell["Formatted output", \
"Subsection",ExpressionUUID->"c60a2f18-17b5-4034-b27c-c83733474f6e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", "]"}]], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"8d4cd393-d782-42c6-bf96-0022898eed7d"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "Out[27]=",ExpressionUUID->"302cf195-50f1-46e5-8d35-f5e76b83e8d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The parity can be changed with the Option Parity.", \
"Item",ExpressionUUID->"fd136193-a4c8-4703-955f-9765a62ab1df"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", 
  RowBox[{"Parity", "\[Rule]", "\"\<Odd\>\""}], "]"}]], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"4ad71592-e57f-4075-99ca-e9e98c64ae00"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"CPM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "Out[28]=",ExpressionUUID->"034e214e-fff3-484c-8d46-82961dfc4925"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Master functions in terms of MP amplitudes", \
"Subsection",ExpressionUUID->"a452968f-61df-495b-896f-3c030ace3d88"],

Cell["\<\
The master functions are linear combinations of MP amplitudes (and \
derivatives).\
\>", "Item",ExpressionUUID->"04f4d153-f8f1-45da-9933-8431f595b167"],

Cell[CellGroupData[{

Cell["We find these by setting MPs\[Rule]True.", \
"Item",ExpressionUUID->"57ccf54f-34dc-4d3e-ae23-cea7efdcd549"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", 
  RowBox[{"MPs", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"ace967ca-241a-4b5f-acfa-93e790c151d7"],

Cell[BoxData[
 FractionBox[
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
      RowBox[{"t", ",", "r"}], "]"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], "r"]}], ")"}]}], " ", "r", " ", 
        RowBox[{
         SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "r"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], "r"]}], ")"}], "2"], " ", 
        RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\
\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\
(\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\
\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
         RowBox[{"t", ",", "r"}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "l"}], ")"}]}], "+", 
       FractionBox[
        RowBox[{"3", " ", "M"}], "r"]}]]}], ")"}]}], 
  RowBox[{"1", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "l"}], ")"}]}]}]]], "Output",
 CellLabel->
  "Out[29]=",ExpressionUUID->"e95b9817-80fb-41dc-9173-22f6377cf627"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gauge", \
"Subsection",ExpressionUUID->"42567d0e-b92d-4381-b5a1-00a62be2d33b"],

Cell["\<\
The master function itself if gauge invariant, but the MP amplitudes that \
form it can be written in different gauges.\
\>", "Item",ExpressionUUID->"c24a0b89-89d2-41ea-91b9-f0799d6db650"],

Cell[CellGroupData[{

Cell["Here is the ZM function written in Lorenz gauge", \
"Item",ExpressionUUID->"cc19ea85-8d79-4646-9771-18ebb6f0054d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{
     RowBox[{"MPs", "\[Rule]", "True"}], ",", 
     RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}]}], "]"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"t", ",", "r"}], "]"}], ",", "Simplify"}], "]"}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"ec1fb478-b59d-49e7-9370-a5b312a2bb26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "r", " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"l", "+", 
    SuperscriptBox["l", "2"]}]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\\\
\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "M"}], "-", 
      RowBox[{"4", " ", "r"}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"6", " ", "M"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "l", "+", 
       SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}]]}]], "Output",
 CellLabel->
  "Out[30]=",ExpressionUUID->"0c32b0fb-a4ec-4d13-a17c-edf15748223a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak forms", \
"Subsection",ExpressionUUID->"6e709c15-a05a-4929-8a36-a16e9f1c8482"],

Cell[CellGroupData[{

Cell["\<\
As with the MP amplitudes, the master functions can be expressed in weak \
forms.\
\>", "Item",ExpressionUUID->"cb2d7171-9243-4c60-a60b-7f1ebd0c716c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{"Weak", "\[Rule]", "True"}], "]"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"t", ",", "r"}], "]"}], ",", "Simplify"}], "]"}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"2cd2341e-9af4-472f-b66f-1e7fba216848"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[31]=",ExpressionUUID->"06fadaa0-6f60-4a90-8ffd-a2e7ec801955"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{
     RowBox[{"Weak", "\[Rule]", "True"}], ",", 
     RowBox[{"MPs", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "[", 
      RowBox[{"r", "-", 
       RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"_", "[", 
      RowBox[{
       RowBox[{"-", "r"}], "+", 
       RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"_", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"b9f9d01c-5852-4b21-aa7c-a855d654c0c5"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\
\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"l", "+", 
       SuperscriptBox["l", "2"]}]], "+", 
     FractionBox[
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\
\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\
\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]]}], 
    ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\
\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"l", "+", 
       SuperscriptBox["l", "2"]}]], "+", 
     FractionBox[
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\
\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\
\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"l", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "l"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", "M"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "l", "+", 
            SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], ")"}]}]]}], 
    ")"}]}], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*RowBox[{\\\"G\\\", \\\"[\\\", \\\"\\\\\\\"\\\\\\\\!\
\\\\\\\\(\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*\
RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"rr\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"RWZ\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"\\\\\\\\\\\\\\\"], \\\\\\\\\\\\\\\"Superscript\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\\\\\\\)\\\\\\\"\\\", \\\"]\\\"}]\\)\"\>", 
     "[", "t", "]"}]}], 
   RowBox[{"l", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "l"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", "M"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "l", "+", 
         SuperscriptBox["l", "2"]}], ")"}], " ", "r"}]}], 
     ")"}]}]]}]], "Output",
 CellLabel->
  "Out[32]=",ExpressionUUID->"03480d41-4a21-40cd-ae7c-4ad852728c54"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellFrameLabels->{{
    FEPrivate`If[
     FEPrivate`Or[
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "6.0"], 
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "7.0"], 
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "8.0"]], 
     Cell[
      TextData[
       ButtonBox[
       "RELATED TUTORIALS", BaseStyle -> None, 
        Appearance -> {Automatic, None}, Evaluator -> None, Method -> 
        "Preemptive", ButtonFunction :> (FrontEndExecute[{
           FrontEnd`SelectionMove[
            FrontEnd`SelectedNotebook[], All, ButtonCell], 
           FrontEndToken["OpenCloseGroup"], 
           FrontEnd`SelectionMove[
            FrontEnd`SelectedNotebook[], After, CellContents]}]& )]], 
      "RelatedTutorialsSection"], 
     TextData[
      ButtonBox[
       Cell[
        TextData[{
          Cell[
           BoxData[
            TemplateBox[{24}, "Spacer1"]]], "Related Tutorials"}], 
        "RelatedTutorialsSection"], BaseStyle -> None, 
       Appearance -> {Automatic, None}, Evaluator -> None, Method -> 
       "Preemptive", ButtonFunction :> (FrontEndExecute[{
          FrontEnd`SelectionMove[
           FrontEnd`SelectedNotebook[], All, ButtonCell], 
          FrontEndToken["OpenCloseGroup"], 
          FrontEnd`SelectionMove[
           FrontEnd`SelectedNotebook[], After, CellContents]}]& )]]], None}, {
   None, None}},
 CellFrameLabelMargins->
  0,ExpressionUUID->"2707006c-6979-4271-97d8-b5b1b5ad36d3"],

Cell[TextData[ButtonBox["Field equations on Schwarzschild",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Field equations on Schwarzschild"]], \
"RelatedTutorials",ExpressionUUID->"b0e3b475-6a29-4159-9f7f-1d1b9df1b90c"],

Cell[TextData[ButtonBox["Conventions",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Conventions"]], \
"RelatedTutorials",ExpressionUUID->"ab4ce3d9-265f-4ca2-9886-33a73e9ae823"],

Cell[TextData[ButtonBox["Using labels to act on groups of variables",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Using labels to act on groups of \
variables"]], \
"RelatedTutorials",ExpressionUUID->"ca2c5190-c02d-448b-b0f2-8e95196c908e"],

Cell[TextData[ButtonBox["Weak functions",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Weak functions"]], \
"RelatedTutorials",ExpressionUUID->"cb70dc5b-d856-4233-86a2-73acba597ad2"],

Cell[TextData[ButtonBox["Discontinuities",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Discontinuities"]], \
"RelatedTutorials",ExpressionUUID->"274d60c2-3ed4-4b4e-ac3f-06ce4bc589bb"],

Cell[TextData[ButtonBox["Examples",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Examples"]], \
"RelatedTutorials",ExpressionUUID->"e7d6d9b6-e4d7-466f-bc0c-604acc47e357"]
}, Open  ]]
}, Open  ]],

Cell[" ", \
"FooterCell",ExpressionUUID->"a2309b2a-c700-44fe-970f-89cedd7282c5"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Time domain amplitudes",
Visible->True,
PrivateNotebookOptions->{"FileOutlineCache"->False},
TaggingRules->{
 "ModificationHighlight" -> False, 
  "Metadata" -> {
   "context" -> "BlackHoleAnalysis`", 
    "keywords" -> {"Sources", "Master", "Equation", "Field"}, "index" -> True,
     "label" -> "Time domain amplitudes", "language" -> "en", "paclet" -> 
    "Time domain amplitudes", "status" -> "None", "summary" -> 
    "Time domain amplitudes", "synonyms" -> {}, "title" -> 
    "Time domain amplitudes", "windowTitle" -> "Time domain amplitudes", 
    "type" -> "Tutorial", "uri" -> 
    "BlackHoleAnalysis/tutorial/Time domain amplitudes", "WorkflowDockedCell" -> 
    ""}, "SearchTextTranslated" -> "", "LinkTrails" -> ""},
TrackCellChangeTimes->False,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Reference.nb", 
  CharacterEncoding -> "UTF-8"]
]

