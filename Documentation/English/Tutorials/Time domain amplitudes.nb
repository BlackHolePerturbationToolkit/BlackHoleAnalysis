Notebook[{
Cell[" ", "TutorialColorBar",
 CellMargins->{{Inherited, Inherited}, {-5, 
   0}},ExpressionUUID->"b4008f27-63b9-402f-80b9-8b968d69178b"],

Cell[TextData[{
 ButtonBox["BlackHoleAnalysis",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->"paclet:BlackHoleAnalysis/guide/BlackHoleAnalysis"],
 StyleBox[" > ", "LinkTrailSeparator"],
 ButtonBox["Time domain amplitudes",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->"paclet:BlackHoleAnalysis/tutorial/Time domain amplitudes"]
}], "LinkTrail",ExpressionUUID->"0969fb61-5037-43ee-b14a-9f7d93068f34"],

Cell[BoxData[GridBox[{
   {Cell["TIME DOMAIN AMPLITUDES TUTORIAL", "PacletNameCell",ExpressionUUID->
     "b8450c79-c23e-450b-9a7f-4b037bb47c1e"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"Related Tutorials \[RightGuillemet]\"\>",
        StripOnInput->False], {
       RowBox[{"Field", " ", "equations", " ", "on", " ", "Schwarzschild"}]:>
       Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Field equations on Schwarzschild"], 
       "Conventions":>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Conventions"], 
       RowBox[{
       "Using", " ", "labels", " ", "to", " ", "act", " ", "on", " ", 
        "groups", " ", "of", " ", "variables"}]:>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Using labels to act on groups of \
variables"], 
       RowBox[{"Weak", " ", "functions"}]:>Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Weak functions"], "Discontinuities":>
       Documentation`HelpLookup[
       "paclet:BlackHoleAnalysis/tutorial/Discontinuities"], "Examples":>
       Documentation`HelpLookup["paclet:BlackHoleAnalysis/tutorial/Examples"]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "cd49e16b-d512-47f4-a6bc-f266d0a0e83f"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"URL \[RightGuillemet]\"\>",
        StripOnInput->False], {"\<\"Go to BlackHoleAnalysis website\"\>":>
       FrontEndExecute[{
         NotebookLocate[{
           URL[None], None}]}], 
       Delimiter, "\<\"Go to wolfram Mathematica website\"\>":>
       FrontEndExecute[{
         NotebookLocate[{
           URL[
           "http://reference.wolfram.com/mathematica/guide/Mathematica.html"],
            None}]}]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "fd71411d-fe70-4a15-bc90-0a224ab31c16"]
    }], "AnchorBar",ExpressionUUID->"b3ab36ee-9ffc-4615-935a-dec6f2a7bc8b"]}
  }]], "AnchorBarGrid",ExpressionUUID->"14de8a76-d6b7-4f39-968a-5c0de20aa1cc"],

Cell[CellGroupData[{

Cell["BlackHoleAnalysis - Time domain amplitudes on Schwarzschild", \
"Title",ExpressionUUID->"909fa999-852f-4f93-b2fc-9b22269099f7"],

Cell[BoxData[
 RowBox[{"<<", "BlackHoleAnalysis`"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"4ee34b31-4928-4705-a554-7c7bd1f47faf"],

Cell[CellGroupData[{

Cell["Metric perturbation amplitudes", \
"Section",ExpressionUUID->"f189f6db-e874-4a3b-8a6a-484eef670bf4"],

Cell["\<\
BlackHoleAnalysis provides expressions for many scalar amplitudes that exist \
on a Schwarzschild background.\
\>", "Item",ExpressionUUID->"5d32bbf7-9d95-4f7b-891a-bb5a211ba79c"],

Cell["\<\
For instance, here is the metric perturbation amplitudes \
\[ScriptCapitalK][t,r]\
\>", "Item",ExpressionUUID->"f2bdd785-7051-4e25-bec0-848f414a4a87"],

Cell[CellGroupData[{

Cell["Formatted output of amplitudes", \
"Subsection",ExpressionUUID->"988ab8fb-4dfb-49cf-95d7-7fce923e1498"],

Cell[CellGroupData[{

Cell["\<\
By default it has a tag \[OpenCurlyDoubleQuote]RWZ\[CloseCurlyDoubleQuote] to \
indicate that it is a Regge-Wheeler-Zerilli-gauge amplitude.\
\>", "Item",ExpressionUUID->"b300cd99-1fa3-4012-b0b8-bb0cd27aab6e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", "]"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"b5e75555-b029-4dcc-b6ad-6fbc8df81747"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->"Out[2]=",ExpressionUUID->"c640007d-b005-4c4c-b57b-3c66af5bd5f4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric reconstruction from master functions", \
"Subsection",ExpressionUUID->"46bd3e57-349e-416e-b6e7-29dec4d1b10e"],

Cell[CellGroupData[{

Cell["\<\
In this gauge, \[ScriptCapitalK] can be written in terms of the Zerilli \
master function.\
\>", "Item",ExpressionUUID->"ed2274dc-4ac1-47e7-9947-92d89294ef3f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Reconstruct", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"d4245f86-de71-49ad-88af-1b984d705b52"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"Q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->"Out[3]=",ExpressionUUID->"7a69ae50-8bb4-490e-b636-58fe8ca39ec9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Changing gauges", \
"Subsection",ExpressionUUID->"d624f148-7c15-45b8-b329-59d9c9afffe7"],

Cell[CellGroupData[{

Cell["Instead, we may wish to write this in Lorenz gauge", \
"Item",ExpressionUUID->"faa0a92a-ae44-450e-8721-7a0d377320fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], "]"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"dda0fb70-4b86-45f0-989a-c5cea917266c"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->"Out[4]=",ExpressionUUID->"23d85863-8d38-4222-91ff-76ff64586651"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Now, there is no reconstruction possible.", \
"Item",ExpressionUUID->"caa6026c-cf27-4231-aa50-150ca978e50b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"Reconstruct", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"e8098307-91f0-49f4-9460-38b964a2dcf3"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"MP amplitude \"\>", 
   "\[InvisibleSpace]", \
"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*RowBox[{\
\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", 
   "\[InvisibleSpace]", "\<\" cannot be reconstructed from master function in \
\"\>", "\[InvisibleSpace]", "\<\"Lorenz\"\>", 
   "\[InvisibleSpace]", "\<\" gauge.\"\>"}],
  SequenceForm["MP amplitude ", 
   $CellContext`\[ScriptCapitalK]["Tags" -> {"Up" -> {"LorenzTag"}}], 
   " cannot be reconstructed from master function in ", "Lorenz", " gauge."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"a2dd20a2-79bf-4b9a-9440-01519958476b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Set Option PushFrom->\\\"RWZ\\\" to reconstruct the amplitude \
in RWZ gauge and transform it to \"\>", "\[InvisibleSpace]", "\<\"Lorenz\"\>",
    "\[InvisibleSpace]", "\<\" gauge.\"\>"}],
  SequenceForm[
  "Set Option PushFrom->\"RWZ\" to reconstruct the amplitude in RWZ gauge and \
transform it to ", "Lorenz", " gauge."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"a9bb5bc4-b1bc-4e40-b058-d91d812f5dbe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Aborting in \"\>", "\[InvisibleSpace]", 
   "BlackHoleAnalysis`Fields`Private`getMPAmplitude", 
   "\[InvisibleSpace]", "\<\"[].\"\>"}],
  SequenceForm[
  "Aborting in ", BlackHoleAnalysis`Fields`Private`getMPAmplitude, "[]."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"457d9cb6-b494-40b5-8448-0650348700b5"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->"Out[5]=",ExpressionUUID->"98659cf3-1654-4a37-8445-540a37c0b84d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
However, there is the possibility to write \[ScriptCapitalK] as a Lorenz \
gauge amplitude that has been pushed from RWZ gauge\
\>", "Item",ExpressionUUID->"80915119-2de5-4e40-b27f-c1458d6fbf08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"PushFrom", "\[Rule]", "\"\<RWZ\>\""}]}], "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"5c8da947-18c8-41c3-86f3-f14341788c76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
   RowBox[{"t", ",", "r"}], "]"}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], "r"]}]], "Output",
 CellLabel->"Out[6]=",ExpressionUUID->"ba08617d-62e6-4806-9e2c-e9d7ffc2a4dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Now, reconstruction is possible.", \
"Item",ExpressionUUID->"d8080b8a-1250-4dec-b66f-02b9084dbfef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"PushFrom", "\[Rule]", "\"\<RWZ\>\""}], ",", 
   RowBox[{"Reconstruct", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"fdd63e2c-0611-45a7-a3b6-f8ae352f7ded"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"Q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], "r"]}]], "Output",
 CellLabel->"Out[7]=",ExpressionUUID->"6ddab737-1dd2-492d-8120-3766ba504c54"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gauge invariant amplitudes", "Subsection",
 CellChangeTimes->{{3.741350078909013*^9, 
  3.7413500837291517`*^9}},ExpressionUUID->"8a2bb621-1ccd-41e0-896a-\
11035cf4a097"],

Cell[TextData[{
 "Martel & Poisson (",
 ButtonBox["arxiv.org/abs/gr-qc/0502028",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/gr-qc/0502028"], None},
  ButtonNote->"https://arxiv.org/abs/gr-qc/0502028"],
 ") give 6 gauge invariant amplitudes."
}], "Item",
 CellChangeTimes->{{3.741350101486623*^9, 
  3.741350124011023*^9}},ExpressionUUID->"ebb398c2-b44d-4aa0-bc3c-\
b07b79c85b9e"],

Cell[CellGroupData[{

Cell["They are equal to the RWZ gauge amplitudes.", "Item",
 CellChangeTimes->{{3.741350101486623*^9, 
  3.741350131636654*^9}},ExpressionUUID->"97c27ea8-d2b3-4c47-93f9-\
c3df7825ceea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "HttInvariantAmplitude"}]], "Input",
 CellChangeTimes->{{3.741350145660314*^9, 3.741350145958117*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"5e83af30-d09d-4252-a1fe-8ccc43e33cdc"],

Cell[BoxData[
 RowBox[{"\<\"HttInvariantAmplitude[] returns the gauge-invariant metric \
perturbation amplitude h_tt in symbolic form.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/HttInvariantAmplitude"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info83741357196-9892469",ExpressionUUID->"caa948c9-00f8-4857-a751-\
b4d7c0789fba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttInvariantAmplitude", "[", "]"}]], "Input",
 CellChangeTimes->{{3.74135013869496*^9, 3.74135014115154*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"6a3a8cf7-4ffe-4320-b8bd-fc0ef026f3eb"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\\\\\
\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"tt\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->"Out[9]=",ExpressionUUID->"0b342481-c22c-4f03-b038-138723329544"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["In another gauge there are more terms", "Item",
 CellChangeTimes->{{3.741350164908155*^9, 
  3.741350182337193*^9}},ExpressionUUID->"03d7367d-2ac2-41a5-b3c4-\
47757a7c6d6e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttInvariantAmplitude", "[", 
  RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.741350153971806*^9, 3.74135015720079*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8cd4fd76-d9c3-4085-b148-6c3c1185d511"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "M"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\
\\\\(\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"t\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\\\
\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"tt\\\\\\\\\\\\\\\
\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
   RowBox[{"t", ",", "r"}], "]"}], "+", 
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellLabel->
  "Out[10]=",ExpressionUUID->"40de7f99-4bae-4329-b0d6-53e0652f9f11"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Low-order modes", "Subsection",
 CellChangeTimes->{{3.741350316371502*^9, 
  3.741350319392022*^9}},ExpressionUUID->"8125b1bd-856d-47d9-a941-\
b9a5cb3a6a7a"],

Cell["Some low order modes are known exactly.", "Item",
 CellChangeTimes->{{3.7413503247039967`*^9, 
  3.74135033367857*^9}},ExpressionUUID->"8eb370d2-bc88-42ec-81cd-\
bc4f2b5023d5"],

Cell[CellGroupData[{

Cell["Zerilli\[CloseCurlyQuote]s solutions are built-in.", "Item",
 CellChangeTimes->{{3.7413503247039967`*^9, 
  3.741350339315797*^9}},ExpressionUUID->"294ff96a-aca1-412a-bc37-\
9cb7456a0133"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttAmplitude", "[", 
  RowBox[{
   RowBox[{"Mode", "\[Rule]", "\"\<Monopole\>\""}], ",", 
   RowBox[{"ExpandZerilli", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7413503413067093`*^9, 3.741350360893955*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"d261aefd-9a38-4bb4-bf38-07f2ab939214"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    SqrtBox["\[Pi]"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], "r"], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SqrtBox["\[Pi]"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["\[ScriptCapitalE]", "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox["\[ScriptCapitalL]", "2"], 
          SuperscriptBox[
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"2", " ", "M"}], 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{"\[ScriptCapitalE]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]]}]], "Output",
 CellLabel->
  "Out[11]=",ExpressionUUID->"cf661b4a-8cea-4539-9766-3a273400b101"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttAmplitude", "[", 
  RowBox[{
   RowBox[{"Mode", "\[Rule]", "\"\<Dipole\>\""}], ",", 
   RowBox[{"ExpandZerilli", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.741350372506981*^9, 3.7413503737298517`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"feb898c7-328f-4df2-a057-23b2ee34d932"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}]], 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Phi]\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]], " ", 
    SqrtBox[
     FractionBox[
      RowBox[{"2", " ", "\[Pi]"}], "3"]], " ", "r", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
       SuperscriptBox["r", "3"]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], 
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ScriptCapitalE]", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"6", " ", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{
           "\[ImaginaryI]", " ", "\[ScriptCapitalE]", " ", 
            "\[ScriptCapitalL]", " ", 
            RowBox[{
             
             SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
       RowBox[{"\[ScriptCapitalE]", " ", 
        SuperscriptBox[
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "4"]}]]}], 
     ")"}]}]}]}]], "Output",
 CellLabel->
  "Out[12]=",ExpressionUUID->"6bb821b8-c1ce-4475-aabb-23ca219ef301"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Source term expansion", \
"Subsection",ExpressionUUID->"927d25d7-aa90-4cbd-a351-69b75d7af3ab"],

Cell["\<\
When reconstructing MP amplitudes from the master functions, singular source \
terms appear.\
\>", "Item",ExpressionUUID->"8c389c96-459d-45ee-bc04-f68f02213503"],

Cell["We can expand those terms in various ways.", \
"Item",ExpressionUUID->"b656c666-6ca0-47f0-9d8b-2fe7f6cc7ddd"],

Cell[CellGroupData[{

Cell[TextData[{
 "SourceExpansion \[Rule] \[OpenCurlyDoubleQuote]Partial\
\[CloseCurlyDoubleQuote] shows Dirac delta functions explicitly, but hides \
the rest of the source, as in Hopper & Evans (",
 ButtonBox["arxiv.org/abs/1006.4907",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/1006.4907"], None},
  ButtonNote->"https://arxiv.org/abs/1006.4907"],
 ")."
}], "Item",ExpressionUUID->"c11f1b1f-3f48-4034-8355-a1e934e70c7c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
   RowBox[{"SourceExpansion", "\[Rule]", "\"\<Partial\>\""}]}], 
  "]"}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"ee07447f-bba5-4f9a-9010-9cb4462a28eb"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "3"], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", "t", 
     "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[13]=",ExpressionUUID->"63627f02-b457-4a06-8616-ab70023e5477"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SourceExpansion \[Rule] \[OpenCurlyDoubleQuote]Full\
\[CloseCurlyDoubleQuote] shows the full source terms.", \
"Item",ExpressionUUID->"40991cf8-9853-4550-822d-ea81e2fbaca9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
   RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], "]"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"90ec07ce-16e5-4a70-b4da-69356d358ea7"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"8", " ", "\[Pi]", " ", 
    SuperscriptBox["r", "3"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}], "3"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[14]=",ExpressionUUID->"9e5146ed-3a57-44e7-9f5c-74eae0278071"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Note that we can drop these singular terms with RemoveSingular.\
\>", "Item",ExpressionUUID->"90c7da98-b612-4669-aa7b-b266a3e70fc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveSingular"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"4929f056-8ea1-48ba-96d5-6deed74eca61"],

Cell[BoxData[
 RowBox[{"\<\"RemoveSingular[expr] removes all terms in expr not proportional \
to Heaviside functions (this includes derivatives of Heavisides).\"\>", 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/RemoveSingular"]}]], "Print", "PrintUsage",
 CellTags->
  "Info153741357196-9892469",ExpressionUUID->"bcfa097e-3216-4251-b182-\
2e2500454912"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveSingular", "[", 
  RowBox[{"KAmplitude", "[", 
   RowBox[{
    RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
    RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], "]"}], 
  "]"}]], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"fdf21e71-e6d9-4622-8303-6bf6adcd9a0b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\
\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[16]=",ExpressionUUID->"ac62c332-e4dc-48f4-b905-4f9bc044df02"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak fields", \
"Subsection",ExpressionUUID->"66640130-7569-4df5-829d-bf5a84ecf51e"],

Cell[TextData[{
 "It is often useful to consider amplitudes in a weak form, such as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", "(", 
     RowBox[{"t", ",", "r"}], ")"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", "+"], "(", 
       RowBox[{"t", ",", "r"}], ")"}], " ", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{"r", "-", 
        SubscriptBox["r", "p"]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", "-"], "(", 
       RowBox[{"t", ",", "r"}], ")"}], " ", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{
        SubscriptBox["r", "p"], "-", "r"}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"11c4be7e-060f-4d6a-b0ae-683a7607d537"],
 "."
}], "Item",ExpressionUUID->"1f073c12-4976-46d3-a4a4-48e3d4c4b43d"],

Cell["\<\
This functionality is built into BlackHoleAnalysis at a fundamental level.\
\>", "Item",ExpressionUUID->"3bc3afa5-9cf0-47a2-be30-0dfcf5437391"],

Cell[CellGroupData[{

Cell[TextData[{
 "For instance, one can use the function MakeFieldWeak, which assumes a ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "1e8d978c-b796-4220-9085-9b9996a5bfa8"],
 " form."
}], "Item",ExpressionUUID->"f4c1ca86-28ae-4981-9df4-deeead0df366"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MakeFieldWeak"}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"d5429ffd-a51f-467d-8eb1-9d5371df338c"],

Cell[BoxData[
 RowBox[{"\<\"MakeFieldWeak[field] replaces the smooth field with a weak \
expression that is (by default) C^-1.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/MakeFieldWeak"]}]], "Print", "PrintUsage",
 CellTags->
  "Info173741357196-9892469",ExpressionUUID->"1460d7b0-25dc-4277-8317-\
4a64cd526e88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeFieldWeak", "[", 
  RowBox[{"KAmplitude", "[", "]"}], "]"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"3db4d603-d216-4a8b-b311-0900c9753858"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[18]=",ExpressionUUID->"510bfb20-babe-404c-be37-cfbf112b10f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["It is easier to use options:", \
"Item",ExpressionUUID->"73162c6b-a327-4faf-afbf-9b43379df399"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Weak", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"5930f420-9ad0-4342-963c-a2de97387563"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[19]=",ExpressionUUID->"fc5d68a5-9845-4db2-b44f-8333e993173d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KWeak", "=", 
  RowBox[{"KAmplitude", "[", 
   RowBox[{
    RowBox[{"Weak", "\[Rule]", "True"}], ",", 
    RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
    RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"cc6c4814-9a10-48f2-adb0-46e9dc7b71ca"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"8", " ", "\[Pi]", " ", 
    SuperscriptBox["r", "3"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}], "3"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[20]=",ExpressionUUID->"afcae3ed-b0e5-4b08-8609-153b0155f413"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "There are terms in this expression like ",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{"r", "-", 
     RowBox[{
      SubscriptBox["r", "p"], "[", "t", "]"}]}], "]"}]}]],ExpressionUUID->
  "98f29f8b-cef3-4641-97a2-99f9e1616610"],
 ", which we can rewrite at ",
 Cell[BoxData[
  RowBox[{"\[Delta]", "[", 
   RowBox[{"r", "-", 
    RowBox[{
     SubscriptBox["r", "p"], "[", "t", "]"}]}], "]"}]],ExpressionUUID->
  "0d03d663-a636-4c3e-94d1-0605ebbb8928"],
 " using EvaluateDiscontinuities."
}], "Item",ExpressionUUID->"238fc8a3-8cb7-40cc-b1a7-b124c1a6f1d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluating jumps", \
"Subsection",ExpressionUUID->"54a3bdb7-41bf-4fd0-b3e8-e1846c946053"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "EvaluateDiscontinuities"}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"bf007c58-96b9-4497-8e8f-1546e09c7c1a"],

Cell[BoxData[
 RowBox[{"\<\"EvaluateDiscontinuities[expr] calls EvaluateHeavisides, \
EvaluateDeltas and EvaluateJumps on expr.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/EvaluateDiscontinuities"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info213741357197-9892469",ExpressionUUID->"f5eb4425-5176-4411-9254-\
28190139fdfd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KWeakEval", "=", 
  RowBox[{"EvaluateDiscontinuities", "[", "KWeak", "]"}]}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"7567cdd1-c54b-473d-b749-7a0fb3f0a5ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
      "8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"\[Lambda]", " ", 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
      RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*RowBox[{\\\"\\\\\\\"\\\\\\\\!\
\\\\\\\\(\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"], \\\\\\\\\\\\\\\"Superscript\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\\\\\\\)\\\\\\\"\\\"}]\\)\
\[RightDoubleBracket]\"\>", "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellLabel->
  "Out[22]=",ExpressionUUID->"063092ec-ad88-461d-862e-c2a1f65a34ed"]
}, Open  ]],

Cell[TextData[{
 "The term ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[LeftDoubleBracket]", 
    SuperscriptBox["\[CapitalPsi]", "ZM"], "\[RightDoubleBracket]"}], "[", 
   "t", "]"}]],ExpressionUUID->"f34cef1d-5f5b-4b32-92ab-7b18092a3f97"],
 " is the time-dependent jump in the ZM master function."
}], "Item",ExpressionUUID->"e7d84fe8-e816-4c3c-9afa-b878b9a575ad"],

Cell[CellGroupData[{

Cell["\<\
This, too is built in with the function MasterFunctionDiscontinuities.\
\>", "Item",ExpressionUUID->"3f722fe5-0c85-4f81-8029-c53146ce4f3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MasterFunctionDiscontinuities"}]], "Input",
 CellChangeTimes->{3.741284259289548*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"e94d9ecb-567c-4910-ae43-959f08424ff1"],

Cell[BoxData[
 RowBox[{"\<\"MasterFunctionDiscontinuities[] returns an Association with \
discontinuities in the master function and its first three r \
derivatives.\\nMasterFunctionDiscontinuities[{m,n}] returns an Association \
with discontinuities in the m-th time derivative and n-th r derivative of the \
master function.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/MasterFunctionDiscontinuities"]}]], \
"Print", "PrintUsage",
 CellTags->
  "Info233741357197-9892469",ExpressionUUID->"43997695-8ca4-4ca0-8daf-\
6fc3557ad963"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "There are built-in discontinuities through the third derivative of ",
 Cell[BoxData[
  SuperscriptBox["\[CapitalPsi]", "ZM"]],ExpressionUUID->
  "9a333ac8-5434-49fa-92f8-a4c3cf9cdbab"],
 "."
}], "Item",ExpressionUUID->"5365337a-1683-4656-8619-93c5a27d8cd6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MasterFunctionDiscontinuities", "[", "]"}], "//", 
  "Keys"}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"c9b07381-0fd2-4a28-b281-66d8b9de4c84"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\
\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(r\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubsuperscriptBox[\\(\[PartialD]\
\\), \\(r\\), \\(2\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubsuperscriptBox[\\(\[PartialD]\
\\), \\(r\\), \\(3\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[24]=",ExpressionUUID->"0e4cf7c1-927d-414c-9d2b-478ad523519b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jumps", "=", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"MasterFunctionDiscontinuities", "[", "]"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"681938d8-927e-4087-b2ea-12775a91dbbc"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], " ", 
      RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \
\\\"\\\\\\\"_\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "M"}], "+", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}]}]]}], ",", 
   RowBox[{
    RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(r\\)]\\)\\!\\(\\*TemplateBox[List[\\\"X\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
      "8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "\[Lambda]", " ", 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]}], "+", 
         RowBox[{"\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
          SuperscriptBox[
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "M"}], "+", 
          RowBox[{"\[Lambda]", " ", 
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}], "2"]}]], "+", 
     
     FractionBox[
      RowBox[{"8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", 
       SuperscriptBox["\[ScriptCapitalL]", "2"], " ", "\[Mu]", " ", 
       RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"Y\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\[Phi]\
\\\"], DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalL]", "2"], "+", 
         SuperscriptBox[
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}], "2"]}], ")"}]}]]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellLabel->
  "Out[25]=",ExpressionUUID->"126fad71-db5c-4004-8c70-c30b128f7591"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Using this, we see that the Dirac delta term vanishes and  \
\[ScriptCapitalK] is actually ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "40c0e9f4-502b-4135-8dfe-195e6d3eb358"],
 "."
}], "Item",ExpressionUUID->"80e15f7c-ad10-4898-baca-5bf744cbbce6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"KWeakEval", "/.", "jumps"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"r", "-", 
     RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"0d2e087a-6b72-4d71-a581-6d684bcd5431"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\", \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"], \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
Superscript\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellLabel->
  "Out[26]=",ExpressionUUID->"09cb261d-1e4c-4ea5-9a70-62cc41846f5c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Master functions", \
"Section",ExpressionUUID->"c9bee25b-88e0-4650-8f62-0a316e93b8eb"],

Cell["\<\
The CPM & ZM master functions behave in much the same way as the MP amplitudes\
\>", "Item",ExpressionUUID->"a99a6c27-f759-4ce4-830c-89fa6463cc98"],

Cell["By default the parity is even.", \
"Item",ExpressionUUID->"a5b12545-bb89-442b-9b5f-4c9d2d47019b"],

Cell[CellGroupData[{

Cell["Formatted output", \
"Subsection",ExpressionUUID->"78a38b54-0bcb-473d-9008-3c2a2332bff4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", "]"}]], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"e63250bf-9fd8-4f65-81cc-563a01797181"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "Out[27]=",ExpressionUUID->"123a36b2-3489-4ada-9305-efd4218d6b33"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The parity can be changed with the Option Parity.", \
"Item",ExpressionUUID->"2543563b-594a-48b8-a725-9c77d1dd0ad7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", 
  RowBox[{"Parity", "\[Rule]", "\"\<Odd\>\""}], "]"}]], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"d0308b64-e669-4253-bcfe-77ef1f4be089"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"X\\\", \
\\\"\\\\\\\"CPM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "Out[28]=",ExpressionUUID->"a7ade342-bca1-4110-85b5-da793a8088a4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Master functions in terms of MP amplitudes", \
"Subsection",ExpressionUUID->"db543727-5122-474d-b7a6-0731ccde4020"],

Cell["\<\
The master functions are linear combinations of MP amplitudes (and \
derivatives).\
\>", "Item",ExpressionUUID->"d881f8f2-2a75-4950-b51e-0b7cd3980499"],

Cell[CellGroupData[{

Cell["We find these by setting MPs\[Rule]True.", \
"Item",ExpressionUUID->"04d2d874-c102-4992-acfb-24cf2878727b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", 
  RowBox[{"MPs", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"72d082a7-a825-4014-adf1-0f61b419d05c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
      RowBox[{"t", ",", "r"}], "]"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], "r"]}], ")"}]}], " ", "r", " ", 
        RowBox[{
         SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "r"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], "r"]}], ")"}], "2"], " ", 
        RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\
\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\
(\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\
\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
         RowBox[{"t", ",", "r"}], "]"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "M"}], "r"], "+", "\[Lambda]"}]]}], ")"}]}], 
  RowBox[{"1", "+", "\[Lambda]"}]]], "Output",
 CellLabel->
  "Out[29]=",ExpressionUUID->"5d362ac1-7b17-4362-8ac1-f3112af0afa3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gauge", \
"Subsection",ExpressionUUID->"1313fdca-9e58-459b-b92e-ddfd906b71ee"],

Cell["\<\
The master function itself if gauge invariant, but the MP amplitudes that \
form it can be written in different gauges.\
\>", "Item",ExpressionUUID->"4c818fed-5edf-47cb-b8f7-d0716dbef85b"],

Cell[CellGroupData[{

Cell["Here is the ZM function written in Lorenz gauge", \
"Item",ExpressionUUID->"510e5e48-9c8a-4068-92d0-8391a5ab738e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{
     RowBox[{"MPs", "\[Rule]", "True"}], ",", 
     RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}]}], "]"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"t", ",", "r"}], "]"}], ",", "Simplify"}], "]"}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"a1c31f1d-237f-4570-9b43-6309b84199c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"r", " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"1", "+", "\[Lambda]"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\\\
\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "M"}], "-", 
      RowBox[{"2", " ", "r"}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"3", " ", "M"}], "+", 
    RowBox[{"r", " ", "\[Lambda]"}]}]]}]], "Output",
 CellLabel->
  "Out[30]=",ExpressionUUID->"c7f88b0a-1b74-438d-a773-19cb138ae1c4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak forms", \
"Subsection",ExpressionUUID->"7b560fcf-b6bb-4f13-ae2c-6423a70c49bc"],

Cell[CellGroupData[{

Cell["\<\
As with the MP amplitudes, the master functions can be expressed in weak \
forms.\
\>", "Item",ExpressionUUID->"4415e876-8cd6-4bc4-9a9e-6af01b27eeb5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{"Weak", "\[Rule]", "True"}], "]"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"t", ",", "r"}], "]"}], ",", "Simplify"}], "]"}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"4b3b6daa-de51-4231-ad5d-b4f5f0646b8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\*TemplateBox[List[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"X\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"ZM\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], \\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"Superscript\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\"\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "Out[31]=",ExpressionUUID->"b8bcc7cb-d920-4227-885d-aa482a47a565"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{
     RowBox[{"Weak", "\[Rule]", "True"}], ",", 
     RowBox[{"MPs", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "[", 
      RowBox[{"r", "-", 
       RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"_", "[", 
      RowBox[{
       RowBox[{"-", "r"}], "+", 
       RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"_", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"d54c7476-5e6d-4905-bf5f-c56558291a1a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\
\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"1", "+", "\[Lambda]"}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\
\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\
\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\
\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"1", "+", "\[Lambda]"}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\
\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\
\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*RowBox[{\\\"G\\\", \\\"[\\\", \\\"\\\\\\\"\\\\\\\\!\
\\\\\\\\(\\\\\\\\*TemplateBox[List[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*\
RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"rr\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"RWZ\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"\\\\\\\\\\\\\\\"], \\\\\\\\\\\\\\\"Superscript\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\\\\\\\)\\\\\\\"\\\", \\\"]\\\"}]\\)\"\>", 
     "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}]], "Output",
 CellLabel->
  "Out[32]=",ExpressionUUID->"c536b438-f9e4-405d-8582-cedbd75ffb06"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "RelatedTutorialsSection",
 WholeCellGroupOpener->True,
 CellFrameLabels->{{
    FEPrivate`If[
     FEPrivate`Or[
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "6.0"], 
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "7.0"], 
      FEPrivate`SameQ[FEPrivate`$ProductVersion, "8.0"]], 
     Cell[
      TextData[
       ButtonBox[
       "RELATED TUTORIALS", BaseStyle -> None, 
        Appearance -> {Automatic, None}, Evaluator -> None, Method -> 
        "Preemptive", ButtonFunction :> (FrontEndExecute[{
           FrontEnd`SelectionMove[
            FrontEnd`SelectedNotebook[], All, ButtonCell], 
           FrontEndToken["OpenCloseGroup"], 
           FrontEnd`SelectionMove[
            FrontEnd`SelectedNotebook[], After, CellContents]}]& )]], 
      "RelatedTutorialsSection"], 
     TextData[
      ButtonBox[
       Cell[
        TextData[{
          Cell[
           BoxData[
            TemplateBox[{24}, "Spacer1"]]], "Related Tutorials"}], 
        "RelatedTutorialsSection"], BaseStyle -> None, 
       Appearance -> {Automatic, None}, Evaluator -> None, Method -> 
       "Preemptive", ButtonFunction :> (FrontEndExecute[{
          FrontEnd`SelectionMove[
           FrontEnd`SelectedNotebook[], All, ButtonCell], 
          FrontEndToken["OpenCloseGroup"], 
          FrontEnd`SelectionMove[
           FrontEnd`SelectedNotebook[], After, CellContents]}]& )]]], None}, {
   None, None}},
 CellFrameLabelMargins->
  0,ExpressionUUID->"626c6992-87fd-45af-abf8-b8b49ce12653"],

Cell[TextData[ButtonBox["Field equations on Schwarzschild",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Field equations on Schwarzschild"]], \
"RelatedTutorials",ExpressionUUID->"a57104d6-5ed7-409e-8b46-8057133ea481"],

Cell[TextData[ButtonBox["Conventions",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Conventions"]], \
"RelatedTutorials",ExpressionUUID->"a30dfe94-09b2-4932-b0e2-83104718c6e4"],

Cell[TextData[ButtonBox["Using labels to act on groups of variables",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Using labels to act on groups of \
variables"]], \
"RelatedTutorials",ExpressionUUID->"6bfb0e92-7391-4e2b-bf10-4bd548398cfa"],

Cell[TextData[ButtonBox["Weak functions",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Weak functions"]], \
"RelatedTutorials",ExpressionUUID->"3a2a108f-57cc-48dd-b5ff-f6212ec998d6"],

Cell[TextData[ButtonBox["Discontinuities",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Discontinuities"]], \
"RelatedTutorials",ExpressionUUID->"616ef62f-0b77-4c2b-ac53-f596a4e6f8f5"],

Cell[TextData[ButtonBox["Examples",
 BaseStyle->"Link",
 ButtonData->
  "paclet:BlackHoleAnalysis/tutorial/Examples"]], \
"RelatedTutorials",ExpressionUUID->"4ff0bb76-6b4f-45db-a56a-302e81cfcfa8"]
}, Open  ]]
}, Open  ]],

Cell[" ", \
"FooterCell",ExpressionUUID->"02f4adad-7412-450f-ac34-cbc8fa14a185"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Time domain amplitudes",
Visible->True,
PrivateNotebookOptions->{"FileOutlineCache"->False},
TaggingRules->{
 "ModificationHighlight" -> False, 
  "Metadata" -> {
   "context" -> "BlackHoleAnalysis`", 
    "keywords" -> {"Sources", "Master", "Equation", "Field"}, "index" -> True,
     "label" -> "Time domain amplitudes", "language" -> "en", "paclet" -> 
    "Time domain amplitudes", "status" -> "None", "summary" -> 
    "Time domain amplitudes", "synonyms" -> {}, "title" -> 
    "Time domain amplitudes", "windowTitle" -> "Time domain amplitudes", 
    "type" -> "Tutorial", "uri" -> 
    "BlackHoleAnalysis/tutorial/Time domain amplitudes", "WorkflowDockedCell" -> 
    ""}, "SearchTextTranslated" -> "", "LinkTrails" -> ""},
TrackCellChangeTimes->False,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Reference.nb", 
  CharacterEncoding -> "UTF-8"]
]

