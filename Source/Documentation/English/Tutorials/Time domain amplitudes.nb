(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    100258,       2607]
NotebookOptionsPosition[     85907,       2339]
NotebookOutlinePosition[     87333,       2377]
CellTagsIndexPosition[     87070,       2368]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["BlackHoleAnalysis - Time domain amplitudes on Schwarzschild", "Title",ExpressionUUID->"64364337-75f9-4d80-b087-fea8447864fa"],

Cell[BoxData[
 RowBox[{"<<", "BlackHoleAnalysis`"}]], "Input",
 CellLabel->
  "(Local) In[1]:=",ExpressionUUID->"cd46333a-252c-45d8-946e-49de93b6176b"],

Cell[CellGroupData[{

Cell["Metric perturbation amplitudes", "Section",ExpressionUUID->"a4f0ad77-ad85-45ce-bfdb-36c910ffb77f"],

Cell[CellGroupData[{

Cell["\<\
BlackHoleAnalysis provides expressions for many scalar amplitudes that exist \
on a Schwarzschild background.\
\>", "Item",ExpressionUUID->"06f8f470-abc3-4983-8da2-c8af27fe45c8"],

Cell["\<\
For instance, here is the metric perturbation amplitudes \
\[ScriptCapitalK][t,r]\
\>", "Item",ExpressionUUID->"cdc2e9c4-3c90-43ff-aa3a-0351540e451e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formatted output of amplitudes", "Subsection",ExpressionUUID->"e7238b3c-5c7f-4a76-a767-abd2172f4002"],

Cell["\<\
By default it has a tag \[OpenCurlyDoubleQuote]RWZ\[CloseCurlyDoubleQuote] to \
indicate that it is a Regge-Wheeler-Zerilli-gauge amplitude.\
\>", "Item",ExpressionUUID->"e4a371dc-be4f-4521-ad70-a685f6cb9920"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", "]"}]], "Input",
 CellLabel->
  "(Local) In[2]:=",ExpressionUUID->"877bb8c6-2412-4983-8dc6-f3b281bcbdb2"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "(Local) Out[2]=",ExpressionUUID->"7212e9b9-a795-4745-a6fd-2d3578167aab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric reconstruction from master functions", "Subsection",ExpressionUUID->"7f2b7798-db3f-4574-b0e8-c28093423255"],

Cell["\<\
In this gauge, \[ScriptCapitalK] can be written in terms of the Zerilli \
master function.\
\>", "Item",ExpressionUUID->"530c10f3-93c7-4dc5-b8d3-5e1bd26e2af4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Reconstruct", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->
  "(Local) In[3]:=",ExpressionUUID->"4e5a052d-bb9c-4b87-878f-5330841f4a17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["r", "3"], " ", 
     RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"Q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "M"}], "+", 
       RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\\
)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[3]=",ExpressionUUID->"7e15b077-c6ef-440d-9368-57788b022fd6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Changing gauges", "Subsection",ExpressionUUID->"83e8506d-3563-4979-8cdb-2a7dd79c0cb8"],

Cell["Instead, we may wish to write this in Lorenz gauge", "Item",ExpressionUUID->"6c051465-ae6d-42ab-888b-98112b0ee75f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], "]"}]], "Input",
 CellLabel->
  "(Local) In[4]:=",ExpressionUUID->"3c1da890-0914-46c5-84c0-8db14781b788"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "(Local) Out[4]=",ExpressionUUID->"5aa57693-3e51-41f6-bb86-bf79352b4799"]
}, Open  ]],

Cell["Now, there is no reconstruction possible.", "Item",ExpressionUUID->"e21a3f4a-74d3-4da7-b726-ce738b7a8c13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"Reconstruct", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellLabel->
  "(Local) In[5]:=",ExpressionUUID->"21e4684a-2332-472d-83b0-31cbc63e06f3"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"MP amplitude \"\>", 
   "\[InvisibleSpace]", \
"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*RowBox[{\
\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", 
   "\[InvisibleSpace]", "\<\" cannot be reconstructed from master function in \
\"\>", "\[InvisibleSpace]", "\<\"Lorenz\"\>", 
   "\[InvisibleSpace]", "\<\" gauge.\"\>"}],
  SequenceForm["MP amplitude ", 
   $CellContext`\[ScriptCapitalK]["Tags" -> {"Up" -> {"LorenzTag"}}], 
   " cannot be reconstructed from master function in ", "Lorenz", " gauge."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of (Local) \
In[5]:=",ExpressionUUID->"52adac1e-0618-4009-bf15-59b12abedab1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Set Option PushFrom->\\\"RWZ\\\" to reconstruct the amplitude \
in RWZ gauge and transform it to \"\>", "\[InvisibleSpace]", "\<\"Lorenz\"\>",
    "\[InvisibleSpace]", "\<\" gauge.\"\>"}],
  SequenceForm[
  "Set Option PushFrom->\"RWZ\" to reconstruct the amplitude in RWZ gauge and \
transform it to ", "Lorenz", " gauge."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of (Local) \
In[5]:=",ExpressionUUID->"77b503c9-7118-46eb-86a5-360735165ccb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Aborting in \"\>", "\[InvisibleSpace]", 
   "BlackHoleAnalysis`Fields`Private`getMPAmplitude", 
   "\[InvisibleSpace]", "\<\"[].\"\>"}],
  SequenceForm[
  "Aborting in ", BlackHoleAnalysis`Fields`Private`getMPAmplitude, "[]."],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of (Local) \
In[5]:=",ExpressionUUID->"a9fefae1-280e-486f-9b90-c3c9d04f3366"]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellLabel->
  "(Local) Out[5]=",ExpressionUUID->"dbeb2240-56e5-41fe-8584-90e3c6d53ad4"]
}, Open  ]],

Cell["\<\
However, there is the possibility to write \[ScriptCapitalK] as a Lorenz \
gauge amplitude that has been pushed from RWZ gauge\
\>", "Item",ExpressionUUID->"c4d3e177-e1d0-471b-8f5e-3b27f5b23a97"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"PushFrom", "\[Rule]", "\"\<RWZ\>\""}]}], "]"}]], "Input",
 CellLabel->
  "(Local) In[6]:=",ExpressionUUID->"d791d3a4-696a-439d-8eb8-a654f6cb1f4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
   RowBox[{"t", ",", "r"}], "]"}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], "r"]}]], "Output",
 CellLabel->
  "(Local) Out[6]=",ExpressionUUID->"75065bf2-35f7-4537-b08c-1f98561f4598"]
}, Open  ]],

Cell["Now, reconstruction is possible.", "Item",ExpressionUUID->"d4cd4736-74b8-48ea-9f88-a4c4719bbaf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], ",", 
   RowBox[{"PushFrom", "\[Rule]", "\"\<RWZ\>\""}], ",", 
   RowBox[{"Reconstruct", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellLabel->
  "(Local) In[7]:=",ExpressionUUID->"945e0f6f-2ce1-4125-9b27-909b8648dd4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["r", "3"], " ", 
     RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"Q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "M"}], "+", 
       RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\\
)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\[Xi]\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"e,RWZ,L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], "r"]}]], "Output",
 CellLabel->
  "(Local) Out[7]=",ExpressionUUID->"2fd3db71-a67d-4592-a904-361b33d62fbf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gauge invariant amplitudes", "Subsection",
 CellChangeTimes->{{3.741350078909013*^9, 
  3.7413500837291517`*^9}},ExpressionUUID->"85581c31-27fe-48b5-9892-\
86d8c988afbc"],

Cell[CellGroupData[{

Cell[TextData[{
 "Martel & Poisson (",
 ButtonBox["arxiv.org/abs/gr-qc/0502028",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/gr-qc/0502028"], None},
  ButtonNote->"https://arxiv.org/abs/gr-qc/0502028"],
 ") give 6 gauge invariant amplitudes."
}], "Item",
 CellChangeTimes->{{3.741350101486623*^9, 
  3.741350124011023*^9}},ExpressionUUID->"ece2d8d3-4834-4691-96e8-\
2f6058a56262"],

Cell["They are equal to the RWZ gauge amplitudes.", "Item",
 CellChangeTimes->{{3.741350101486623*^9, 
  3.741350131636654*^9}},ExpressionUUID->"e15f2ede-78f5-4b8d-bb4a-\
ee77c2ae7998"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "HttInvariantAmplitude"}]], "Input",
 CellChangeTimes->{{3.741350145660314*^9, 3.741350145958117*^9}},
 CellLabel->
  "(Local) In[23]:=",ExpressionUUID->"e47244e7-4886-4fc6-9ce8-cefd0b075797"],

Cell[BoxData[
 RowBox[{"\<\"HttInvariantAmplitude[] returns the gauge-invariant metric \
perturbation amplitude h_tt in symbolic form.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/HttInvariantAmplitude"]}]], "Print", \
"PrintUsage",
 CellChangeTimes->{3.741350146337359*^9},
 CellTags->
  "Info233741353746-9883461",ExpressionUUID->"78da4e12-f6d1-4213-b0a7-\
20e39f05ce10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttInvariantAmplitude", "[", "]"}]], "Input",
 CellChangeTimes->{{3.74135013869496*^9, 3.74135014115154*^9}},
 CellLabel->
  "(Local) In[22]:=",ExpressionUUID->"8ef8421e-675c-4a4f-be5e-ed0baacf7421"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\\\\\
\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"tt\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \
\\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellChangeTimes->{3.741350141787273*^9},
 CellLabel->
  "(Local) Out[22]=",ExpressionUUID->"c772aed5-3b83-4c47-8d26-42abbf552d55"]
}, Open  ]],

Cell["In another gauge there are more terms", "Item",
 CellChangeTimes->{{3.741350164908155*^9, 
  3.741350182337193*^9}},ExpressionUUID->"602e8bb8-506f-4ead-bc6e-\
8ea92cefd02c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttInvariantAmplitude", "[", 
  RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.741350153971806*^9, 3.74135015720079*^9}},
 CellLabel->
  "(Local) In[24]:=",ExpressionUUID->"8a80c76f-8705-4dd0-bc97-8bb738f97cf4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "M"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\
\\\\(\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"t\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\\\
\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"tt\\\\\\\\\\\\\\\
\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
   RowBox[{"t", ",", "r"}], "]"}], "+", 
  FractionBox[
   RowBox[{"2", " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{3.741350157605877*^9},
 CellLabel->
  "(Local) Out[24]=",ExpressionUUID->"f6b6bf21-fe2d-48ef-9044-5540ee95d16a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Low-order modes", "Subsection",
 CellChangeTimes->{{3.741350316371502*^9, 
  3.741350319392022*^9}},ExpressionUUID->"67a600cb-6567-4000-8b1b-\
91c4b30ecb31"],

Cell[CellGroupData[{

Cell["Some low order modes are known exactly.", "Item",
 CellChangeTimes->{{3.7413503247039967`*^9, 
  3.74135033367857*^9}},ExpressionUUID->"133552d6-dcc8-4ff0-bb97-\
c4c1913e4968"],

Cell["Zerilli\[CloseCurlyQuote]s solutions are built-in.", "Item",
 CellChangeTimes->{{3.7413503247039967`*^9, 
  3.741350339315797*^9}},ExpressionUUID->"54b11ce8-e24d-431b-84ac-\
ef234b6e6f94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttAmplitude", "[", 
  RowBox[{
   RowBox[{"Mode", "\[Rule]", "\"\<Monopole\>\""}], ",", 
   RowBox[{"ExpandZerilli", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7413503413067093`*^9, 3.741350360893955*^9}},
 CellLabel->
  "(Local) In[33]:=",ExpressionUUID->"06276b50-11d1-406a-92fe-024e2253eb6e"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    SqrtBox["\[Pi]"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], "r"], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SqrtBox["\[Pi]"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["\[ScriptCapitalE]", "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SuperscriptBox["\[ScriptCapitalL]", "2"], 
          SuperscriptBox[
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"2", " ", "M"}], 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{"\[ScriptCapitalE]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.741350347641617*^9, 3.741350361197184*^9}},
 CellLabel->
  "(Local) Out[33]=",ExpressionUUID->"e49464b8-35b0-4c74-bf0a-c234f7d38913"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HttAmplitude", "[", 
  RowBox[{
   RowBox[{"Mode", "\[Rule]", "\"\<Dipole\>\""}], ",", 
   RowBox[{"ExpandZerilli", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.741350372506981*^9, 3.7413503737298517`*^9}},
 CellLabel->
  "(Local) In[34]:=",ExpressionUUID->"f1be69db-c4a8-451b-acbc-91671972f903"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"\[Phi]\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]], " ", 
    SqrtBox[
     FractionBox[
      RowBox[{"2", " ", "\[Pi]"}], "3"]], " ", "r", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "M"}], 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ScriptCapitalE]", " ", 
        RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
       SuperscriptBox["r", "3"]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         SuperscriptBox["\[ScriptCapitalL]", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], 
            
            RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\
\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ScriptCapitalE]", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"6", " ", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{
           "\[ImaginaryI]", " ", "\[ScriptCapitalE]", " ", 
            "\[ScriptCapitalL]", " ", 
            RowBox[{
             
             SuperscriptBox["\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
       RowBox[{"\[ScriptCapitalE]", " ", 
        SuperscriptBox[
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "4"]}]]}], ")"}]}], 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"2", " ", "M"}], "r"]}]]}]], "Output",
 CellChangeTimes->{3.7413503741284657`*^9},
 CellLabel->
  "(Local) Out[34]=",ExpressionUUID->"a999b038-f14c-48aa-97a7-8ba4b24a435c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Source term expansion", "Subsection",ExpressionUUID->"fb11b5e5-e77e-461a-b17c-c68a649405b1"],

Cell[CellGroupData[{

Cell["\<\
When reconstructing MP amplitudes from the master functions, singular source \
terms appear.\
\>", "Item",ExpressionUUID->"cb070e49-51e6-4432-9977-4ed324a50505"],

Cell["We can expand those terms in various ways.", "Item",ExpressionUUID->"43a2662b-6a28-43f6-9692-494d87ccce52"],

Cell[TextData[{
 "SourceExpansion \[Rule] \[OpenCurlyDoubleQuote]Partial\
\[CloseCurlyDoubleQuote] shows Dirac delta functions explicitly, but hides \
the rest of the source, as in Hopper & Evans (",
 ButtonBox["arxiv.org/abs/1006.4907",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/1006.4907"], None},
  ButtonNote->"https://arxiv.org/abs/1006.4907"],
 ")."
}], "Item",ExpressionUUID->"9439f06c-b0fc-4370-bad2-f09db89ba4e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
   RowBox[{"SourceExpansion", "\[Rule]", "\"\<Partial\>\""}]}], 
  "]"}]], "Input",
 CellLabel->
  "(Local) In[8]:=",ExpressionUUID->"b6826ceb-5d93-4911-9eb4-80285fac3499"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["r", "3"], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"r", "-", 
       RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
     RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*RowBox[{\\\\\
\\\"q\\\\\\\"}]\\\\)\\\", \\\"tt\\\"], DisplayForm]\\)\"\>", "[", "t", 
      "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "M"}], "+", 
       RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\\
)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[8]=",ExpressionUUID->"c6d80986-b04d-4fbe-b159-c0e52e55bdf2"]
}, Open  ]],

Cell["SourceExpansion \[Rule] \[OpenCurlyDoubleQuote]Full\
\[CloseCurlyDoubleQuote] shows the full source terms.", "Item",ExpressionUUID-\
>"e3eb31e5-33f0-45fd-b099-fe0f07ce28ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{
   RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
   RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], "]"}]], "Input",
 CellLabel->
  "(Local) In[9]:=",ExpressionUUID->"ba7828bb-6f00-4346-a2c8-b42bcb3e0167"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"8", " ", "\[Pi]", " ", 
    SuperscriptBox["r", "3"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}], "3"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\\
)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[9]=",ExpressionUUID->"f8a96ab9-54f2-430e-a479-1b64b4465ce1"]
}, Open  ]],

Cell["\<\
Note that we can drop these singular terms with RemoveSingular.\
\>", "Item",ExpressionUUID->"62a21fd8-d5dc-4677-80c9-50f2ceb8603c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RemoveSingular"}]], "Input",
 CellLabel->
  "(Local) In[10]:=",ExpressionUUID->"08bde882-e450-485a-bc85-b0c6dc590582"],

Cell[BoxData[
 RowBox[{"\<\"RemoveSingular[expr] removes all terms in expr not proportional \
to Heaviside functions (this includes derivatives of Heavisides).\"\>", 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:BlackHoleAnalysis/ref/RemoveSingular"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info103740837608-2791083",ExpressionUUID->"f10f1477-368b-41db-a78b-\
94b6f4610593"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemoveSingular", "[", 
  RowBox[{"KAmplitude", "[", 
   RowBox[{
    RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
    RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], "]"}], 
  "]"}]], "Input",
 CellLabel->
  "(Local) In[11]:=",ExpressionUUID->"0cbcf7e6-ec9d-4e70-8e75-56128c6e8aee"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\\
)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[11]=",ExpressionUUID->"7e164b16-cb64-45b7-ad8e-0755672eb2f8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak fields", "Subsection",ExpressionUUID->"e6878f83-36d6-4701-8500-3382d0d99f26"],

Cell[CellGroupData[{

Cell[TextData[{
 "It is often useful to consider amplitudes in a weak form, such as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Phi]", "(", 
     RowBox[{"t", ",", "r"}], ")"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", "+"], "(", 
       RowBox[{"t", ",", "r"}], ")"}], " ", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{"r", "-", 
        SubscriptBox["r", "p"]}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]", "-"], "(", 
       RowBox[{"t", ",", "r"}], ")"}], " ", 
      RowBox[{"\[Theta]", "[", 
       RowBox[{
        SubscriptBox["r", "p"], "-", "r"}], "]"}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "74afe895-3ee2-47ab-b586-126b76663bb5"],
 "."
}], "Item",ExpressionUUID->"26ac1ad8-402f-4a1d-bd7d-272cd948aa0e"],

Cell["\<\
This functionality is built into BlackHoleAnalysis at a fundamental level.\
\>", "Item",ExpressionUUID->"f9bed6bd-4cab-47f9-b71e-b8836774e219"],

Cell[TextData[{
 "For instance, one can use the function MakeFieldWeak, which assumes a ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b9ec768a-82bb-4fd9-9fec-c8240dca017b"],
 " form."
}], "Item",ExpressionUUID->"7d366a3a-5072-4f88-8f25-cb2663099628"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MakeFieldWeak"}]], "Input",
 CellLabel->
  "(Local) In[12]:=",ExpressionUUID->"0fba2ee2-dbd8-47dd-afbf-0ba92878e7e0"],

Cell[BoxData[
 RowBox[{"\<\"MakeFieldWeak[field] replaces the smooth field with a weak \
expression that is (by default) C^-1.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:BlackHoleAnalysis/ref/MakeFieldWeak"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info123740837609-2791083",ExpressionUUID->"6fefa591-85d9-41e4-8c3f-\
264e05de5b2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MakeFieldWeak", "[", 
  RowBox[{"KAmplitude", "[", "]"}], "]"}]], "Input",
 CellLabel->
  "(Local) In[13]:=",ExpressionUUID->"2e84bb83-d542-4f5a-8e06-4b5f002deb93"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[13]=",ExpressionUUID->"3a0827b9-b895-410d-acb2-ef47149957ce"]
}, Open  ]],

Cell["It is easier to use options:", "Item",ExpressionUUID->"dfece94b-22b1-4ec7-995d-3543287108b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KAmplitude", "[", 
  RowBox[{"Weak", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->
  "(Local) In[14]:=",ExpressionUUID->"5344573d-204a-473c-8538-fb0c8c1cb74d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[14]=",ExpressionUUID->"0d1163cd-5f7b-4cac-852a-bca761a7d720"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KWeak", "=", 
  RowBox[{"KAmplitude", "[", 
   RowBox[{
    RowBox[{"Weak", "\[Rule]", "True"}], ",", 
    RowBox[{"Reconstruct", "\[Rule]", "True"}], ",", 
    RowBox[{"SourceExpansion", "\[Rule]", "\"\<Full\>\""}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "(Local) In[15]:=",ExpressionUUID->"3c8fba1d-f372-402a-a394-f7f36d640a6b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"8", " ", "\[Pi]", " ", 
    SuperscriptBox["r", "3"], " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}], "3"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", " ", 
       SuperscriptBox["M", "2"]}], "+", 
      RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Theta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\
\"\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\
\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\
\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\\
)\\\\\\\"\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\\
)\\\\\\\"\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[15]=",ExpressionUUID->"4183e9f4-1b12-463d-88a6-d8e46412b12d"]
}, Open  ]],

Cell[TextData[{
 "There are terms in this expression like ",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]",
     MultilineFunction->None], "[", 
    RowBox[{"r", "-", 
     RowBox[{
      SubscriptBox["r", "p"], "[", "t", "]"}]}], "]"}]}]],ExpressionUUID->
  "f0290c0b-7a62-46f6-80bb-9609e70c3b68"],
 ", which we can rewrite at ",
 Cell[BoxData[
  RowBox[{"\[Delta]", "[", 
   RowBox[{"r", "-", 
    RowBox[{
     SubscriptBox["r", "p"], "[", "t", "]"}]}], "]"}]],ExpressionUUID->
  "04c564c4-a068-47d0-a414-70e08ffc8abe"],
 " using EvaluateDiscontinuities."
}], "Item",ExpressionUUID->"ac5cab32-e3e3-4ca5-96b4-1a8a8444dfb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluating jumps", "Subsection",ExpressionUUID->"2603b6f6-44ff-4981-988d-9d0381f171b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "EvaluateDiscontinuities"}]], "Input",
 CellLabel->
  "(Local) In[16]:=",ExpressionUUID->"61934c3a-3a5a-4ca6-99fc-0bf808b63202"],

Cell[BoxData[
 RowBox[{"\<\"EvaluateDiscontinuities[expr] calls EvaluateHeavisides, \
EvaluateDeltas and EvaluateJumps on expr.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/EvaluateDiscontinuities"]}]], "Print", \
"PrintUsage",
 CellTags->
  "Info163740837611-2791083",ExpressionUUID->"12b1726a-bf48-4f10-b852-\
0590329f4c9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KWeakEval", "=", 
  RowBox[{"EvaluateDiscontinuities", "[", "KWeak", "]"}]}]], "Input",
 CellLabel->
  "(Local) In[17]:=",ExpressionUUID->"72254832-64cf-463c-b22b-a038e480a575"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\
\\)\\\\\\\"\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\
\\)\\\\\\\"\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
      "8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"\[Lambda]", " ", 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]]}], ")"}], " ", 
      RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\
\\\\\\\\!\\\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\
\\\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\
\", Rule[SyntaxForm, SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", 
       "]"}]}]}], ")"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[17]=",ExpressionUUID->"76afe0a2-3de9-423a-9fa7-1d2185090b7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "The term ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[LeftDoubleBracket]", 
    SuperscriptBox["\[CapitalPsi]", "ZM"], "\[RightDoubleBracket]"}], "[", 
   "t", "]"}]],ExpressionUUID->"6191bebe-d97c-4419-b63a-b803a2bf9202"],
 " is the time-dependent jump in the ZM master function."
}], "Item",ExpressionUUID->"259345f8-f7f9-437c-b0dc-18984e024ecc"],

Cell["\<\
This, too is built in with the function MasterFunctionDiscontinuities.\
\>", "Item",ExpressionUUID->"1eb6d5f3-5c2c-4fc9-9579-c97c515f4742"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MasterFunctionDiscontinuities"}]], "Input",
 CellChangeTimes->{3.741284259289548*^9},
 CellLabel->
  "(Local) In[8]:=",ExpressionUUID->"ff590090-19fc-4ec1-9e8e-a7fb3904f99b"],

Cell[BoxData[
 RowBox[{"\<\"MasterFunctionDiscontinuities[] returns an Association with \
discontinuities in the master function and its first three r \
derivatives.\\nMasterFunctionDiscontinuities[{m,n}] returns an Association \
with discontinuities in the m-th time derivative and n-th r derivative of the \
master function.\"\>", "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->
    "paclet:BlackHoleAnalysis/ref/MasterFunctionDiscontinuities"]}]], "Print",\
 "PrintUsage",
 CellChangeTimes->{3.741284260083961*^9},
 CellTags->
  "Info83741287860-4776429",ExpressionUUID->"e64a3cda-bc00-4dbf-869c-\
44420f18c2a4"]
}, Open  ]],

Cell[TextData[{
 "There are built-in discontinuities through the third derivative of ",
 Cell[BoxData[
  SuperscriptBox["\[CapitalPsi]", "ZM"]],ExpressionUUID->
  "1c2c4516-0c16-479d-b841-6eb2e962a25c"],
 "."
}], "Item",ExpressionUUID->"3bcde278-b8fd-4db4-8125-5d7367fcf541"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MasterFunctionDiscontinuities", "[", "]"}], "//", 
  "Keys"}]], "Input",
 CellLabel->
  "(Local) In[19]:=",ExpressionUUID->"2f2f4ec6-be89-4742-8c47-2034c2d79e71"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\
\\\\!\\\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\
\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", 
    "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(r\\)]\\)\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*\
RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\
\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubsuperscriptBox[\\(\[PartialD]\
\\), \\(r\\), \
\\(2\\)]\\)\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*\
RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\
\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], ",", 
   RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubsuperscriptBox[\\(\[PartialD]\
\\), \\(r\\), \
\\(3\\)]\\)\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*\
RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\
\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}]}], 
  "}"}]], "Output",
 CellLabel->
  "(Local) Out[19]=",ExpressionUUID->"8b7b6d02-9020-484c-9f0a-d480f7d121a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jumps", "=", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"MasterFunctionDiscontinuities", "[", "]"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellLabel->
  "(Local) In[20]:=",ExpressionUUID->"61e32f7c-35c6-4545-acc1-3b958bab0cb2"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\
\\\\\\!\\\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\
\\\"}]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], " ", 
      RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \
\\\"\\\\\\\"_\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "M"}], "+", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}]}]]}], ",", 
   RowBox[{
    RowBox[{"\<\"\[LeftDoubleBracket]\\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(r\\)]\\)\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*\
RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\
\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\[RightDoubleBracket]\"\>", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox[
      RowBox[{
      "8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "\[Lambda]", " ", 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}]}], "+", 
         RowBox[{"\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
          SuperscriptBox[
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}], "2"]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*OverscriptBox[\\\"Y\\\", \\\"\\\\\\\"_\\\\\\\"\\\
\"]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "M"}], "+", 
          RowBox[{"\[Lambda]", " ", 
           
           RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}]}], ")"}], "2"]}]], "+", 
     
     FractionBox[
      RowBox[{"8", " ", "\[Pi]", " ", "\[ScriptCapitalE]", " ", 
       SuperscriptBox["\[ScriptCapitalJ]", "2"], " ", "\[Mu]", " ", 
       RowBox[{"\<\"\\!\\(\\*TagBox[SubscriptBox[\\\"\\\\!\\\\(\\\\*\
OverscriptBox[\\\\\\\"Y\\\\\\\", \
\\\\\\\"\\\\\\\\\\\\\\\"_\\\\\\\\\\\\\\\"\\\\\\\"]\\\\)\\\", \\\"\[Phi]\[Phi]\
\\\"], DisplayForm]\\)\"\>", "[", "t", "]"}]}], 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "2"], "+", 
         SuperscriptBox[
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\
\\\"]\\)\"\>", "[", "t", "]"}], "2"]}], ")"}]}]]}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellLabel->
  "(Local) Out[20]=",ExpressionUUID->"751349d3-7b77-4771-a4b2-7d53be63c436"]
}, Open  ]],

Cell[TextData[{
 "Using this, we see that the Dirac delta term vanishes and  \
\[ScriptCapitalK] is actually ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5c1857df-cef0-4284-8acb-a8a78d57fef0"],
 "."
}], "Item",ExpressionUUID->"25ee559b-f0f6-4652-b9c5-4c60b3d9d027"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"KWeakEval", "/.", "jumps"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"r", "-", 
     RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellLabel->
  "(Local) In[21]:=",ExpressionUUID->"2c8887bf-8ae4-4592-ae64-fd7bd406a536"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\
\\)\\\\\\\"\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          SuperscriptBox["M", "2"]}], "+", 
         RowBox[{"3", " ", "M", " ", "r", " ", "\[Lambda]"}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", "\[Lambda]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"2", " ", "M"}], "r"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\
\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\
\\)\\\\\\\"\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "r"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[21]=",ExpressionUUID->"40a5cc2a-b2e0-4f07-810f-5d819d6a8ef2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Master functions", "Section",ExpressionUUID->"e7181691-5dfd-49fe-b8df-2574478bbc10"],

Cell[CellGroupData[{

Cell["\<\
The CPM & ZM master functions behave in much the same way as the MP amplitudes\
\>", "Item",ExpressionUUID->"36a78f48-bde0-4d93-89ff-ffe9122b286d"],

Cell["By default the parity is even.", "Item",ExpressionUUID->"5a435a34-e2a1-4bda-9aa0-c8705bebb774"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formatted output", "Subsection",ExpressionUUID->"197169e0-d9fa-45c0-ba2a-bdd337ddf1f7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", "]"}]], "Input",
 CellLabel->
  "(Local) In[22]:=",ExpressionUUID->"b7f54844-ccf2-4fc9-943b-d85628aabb10"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\
\", \\\"\\\\\\\"ZM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "(Local) Out[22]=",ExpressionUUID->"d4354284-9d65-4b00-876e-11cb7d90b33a"]
}, Open  ]],

Cell["The parity can be changed with the Option Parity.", "Item",ExpressionUUID->"0c24c777-815e-4829-b558-239eb356569b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", 
  RowBox[{"Parity", "\[Rule]", "\"\<Odd\>\""}], "]"}]], "Input",
 CellLabel->
  "(Local) In[23]:=",ExpressionUUID->"5e296270-c772-4d09-acc3-5d263233a5ed"],

Cell[BoxData[
 RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\\
*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\\\
\", \\\"\\\\\\\"CPM\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
  RowBox[{"t", ",", "r"}], "]"}]], "Output",
 CellLabel->
  "(Local) Out[23]=",ExpressionUUID->"9701ee26-49d1-41ff-bf73-ee19a6b8d772"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Master functions in terms of MP amplitudes", "Subsection",ExpressionUUID->"2aedad6a-ba82-4c57-91e6-689a18366bb1"],

Cell[CellGroupData[{

Cell["\<\
The master functions are linear combinations of MP amplitudes (and \
derivatives).\
\>", "Item",ExpressionUUID->"a812087f-ac5c-4f76-bb5b-ff081e9ce1b1"],

Cell["We find these by setting MPs\[Rule]True.", "Item",ExpressionUUID->"39fbe266-de2e-45fe-88ca-ccb0d8fdbbff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MasterFunction", "[", 
  RowBox[{"MPs", "\[Rule]", "True"}], "]"}]], "Input",
 CellLabel->
  "(Local) In[24]:=",ExpressionUUID->"c1b5724b-4e40-43dc-b6ca-22f41d85b152"],

Cell[BoxData[
 FractionBox[
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
      RowBox[{"t", ",", "r"}], "]"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], "r"]}], ")"}]}], " ", "r", " ", 
        RowBox[{
         SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "r"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", " ", "M"}], "r"]}], ")"}], "2"], " ", 
        RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\
\\\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\\
(\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\
\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
         RowBox[{"t", ",", "r"}], "]"}]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "M"}], "r"], "+", "\[Lambda]"}]]}], ")"}]}], 
  RowBox[{"1", "+", "\[Lambda]"}]]], "Output",
 CellLabel->
  "(Local) Out[24]=",ExpressionUUID->"a1242871-68d6-4861-b91a-1afd52b9de8f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gauge", "Subsection",ExpressionUUID->"78cc6ba2-e5ff-408e-aa99-4f34634545ec"],

Cell[CellGroupData[{

Cell["\<\
The master function itself if gauge invariant, but the MP amplitudes that \
form it can be written in different gauges.\
\>", "Item",ExpressionUUID->"aab919d1-a288-46d3-aadd-47cc250cfcb6"],

Cell["Here is the ZM function written in Lorenz gauge", "Item",ExpressionUUID->"8503d4dd-65a4-4b6a-a39f-5fb36c7acf1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{
     RowBox[{"MPs", "\[Rule]", "True"}], ",", 
     RowBox[{"Gauge", "\[Rule]", "\"\<Lorenz\>\""}]}], "]"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"t", ",", "r"}], "]"}], ",", "Simplify"}], "]"}]], "Input",
 CellLabel->
  "(Local) In[29]:=",ExpressionUUID->"bfb529f6-742b-448b-989e-9276a232bb13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalG]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\
\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"r", " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{"1", "+", "\[Lambda]"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{
     SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\
\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\
\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\\\
\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"L\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "M"}], "-", 
      RowBox[{"2", " ", "r"}]}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\\\
\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"j\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"r\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\
\\\\\"L\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"3", " ", "M"}], "+", 
    RowBox[{"r", " ", "\[Lambda]"}]}]]}]], "Output",
 CellLabel->
  "(Local) Out[29]=",ExpressionUUID->"8fa29104-2c46-49ab-a711-3ffdbfd45eb7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak forms", "Subsection",ExpressionUUID->"3a70b2f1-3b5f-428c-8983-ecc5eff15184"],

Cell["\<\
As with the MP amplitudes, the master functions can be expressed in weak \
forms.\
\>", "Item",ExpressionUUID->"6b94d810-cd82-49f9-ad5e-7477ab85b3c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{"Weak", "\[Rule]", "True"}], "]"}], ",", 
   RowBox[{"_", "[", 
    RowBox[{"t", ",", "r"}], "]"}], ",", "Simplify"}], "]"}]], "Input",
 CellLabel->
  "(Local) In[30]:=",ExpressionUUID->"bcdeb50a-4db8-4063-bde0-c3861f3f0b84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\
\\\", \\\"\\\\\\\"ZM,-\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\
\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[CapitalPsi]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\\\\\"\
\\\", \\\"\\\\\\\"ZM,+\\\\\\\"\\\"], \\\"Superscript\\\", Rule[SyntaxForm, \
SuperscriptBox]]\\)\"\>", "[", 
    RowBox[{"t", ",", "r"}], "]"}]}]}]], "Output",
 CellLabel->
  "(Local) Out[30]=",ExpressionUUID->"6467927c-1a5c-4e0d-8cc8-47947dc45ebd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"MasterFunction", "[", 
    RowBox[{
     RowBox[{"Weak", "\[Rule]", "True"}], ",", 
     RowBox[{"MPs", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "[", 
      RowBox[{"r", "-", 
       RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"_", "[", 
      RowBox[{
       RowBox[{"-", "r"}], "+", 
       RowBox[{"rp", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"_", "[", 
      RowBox[{"t", ",", "r"}], "]"}]}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellLabel->
  "(Local) In[31]:=",ExpressionUUID->"f7f9a96a-b0a2-4c86-9143-e3d35c7e2e71"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], " ", 
    RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\
\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\\\
\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
     RowBox[{"t", ",", "r"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{
     RowBox[{"-", "r"}], "+", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\
\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"1", "+", "\[Lambda]"}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\
\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\
\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,-\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]", "[", 
    RowBox[{"r", "-", 
     RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \\\"\\\\\\\"p\\\\\\\"\\\"]\
\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\\\\\\\\)\
\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{"1", "+", "\[Lambda]"}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "M"}], "-", "r"}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\
\\\\\\(\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\"\\\\[ScriptCapitalK]\\\\\\\\\\\\\\\"}]\
\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \\\"Superscript\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
       RowBox[{"\<\"\\!\\(\\*TemplateBox[List[\\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\
\\\\\\*TagBox[SubscriptBox[\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\\\\(\
\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\"}]\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\"rr\\\\\\\\\\\
\\\\\"], DisplayForm]\\\\\\\\)\\\\\\\"\\\", \\\"\\\\\\\"RWZ,+\\\\\\\"\\\"], \
\\\"Superscript\\\", Rule[SyntaxForm, SuperscriptBox]]\\)\"\>", "[", 
        RowBox[{"t", ",", "r"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "M"}], "+", 
         RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "M"}], "+", "r"}], ")"}], "2"], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"r", "-", 
      RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\\"r\\\", \
\\\"\\\\\\\"p\\\\\\\"\\\"]\\)\"\>", "[", "t", "]"}]}], "]"}], " ", 
    RowBox[{"\<\"\\!\\(\\*RowBox[{OverscriptBox[\\\"G\\\", \\\"~\\\"], \
\\\"[\\\", \\\"\\\\\\\"\\\\\\\\!\\\\\\\\(\\\\\\\\*TemplateBox[List[\\\\\\\\\\\
\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*TagBox[\
SubscriptBox[\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\!\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\(\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*RowBox[{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\"h\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"}]\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"rr\\\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"], DisplayForm]\\\\\\\\\\\
\\\\\\\\\\\\\\\\\\\\\\)\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\\\\\\\\\\\\\\\", \\\\\
\\\\\\\\\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"RWZ\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
\"\\\\\\\\\\\\\\\"], \\\\\\\\\\\\\\\"Superscript\\\\\\\\\\\\\\\", \
Rule[SyntaxForm, SuperscriptBox]]\\\\\\\\)\\\\\\\"\\\", \\\"]\\\"}]\\)\"\>", 
     "[", "t", "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "\[Lambda]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "M"}], "+", 
      RowBox[{"r", " ", "\[Lambda]"}]}], ")"}]}]]}]], "Output",
 CellLabel->
  "(Local) Out[31]=",ExpressionUUID->"5021e961-534d-4fb3-adb6-045c3ca5b94d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1680, 1005},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info103740837608-2791083"->{
  Cell[32724, 912, 473, 12, 47, "Print",ExpressionUUID->"f10f1477-368b-41db-a78b-94b6f4610593",
   CellTags->"Info103740837608-2791083"]},
 "Info123740837609-2791083"->{
  Cell[36802, 1040, 436, 11, 47, "Print",ExpressionUUID->"6fefa591-85d9-41e4-8c3f-264e05de5b2a",
   CellTags->"Info123740837609-2791083"]},
 "Info163740837611-2791083"->{
  Cell[47483, 1330, 452, 12, 47, "Print",ExpressionUUID->"12b1726a-bf48-4f10-b852-0590329f4c9e",
   CellTags->"Info163740837611-2791083"]},
 "Info233741353746-9883461"->{
  Cell[14950, 419, 499, 13, 47, "Print",ExpressionUUID->"78da4e12-f6d1-4213-b0a7-20e39f05ce10",
   CellTags->"Info233741353746-9883461"]},
 "Info83741287860-4776429"->{
  Cell[54143, 1514, 698, 16, 70, "Print",ExpressionUUID->"e64a3cda-bc00-4dbf-869c-44420f18c2a4",
   CellTags->"Info83741287860-4776429"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info103740837608-2791083", 86227, 2350},
 {"Info123740837609-2791083", 86397, 2353},
 {"Info163740837611-2791083", 86568, 2356},
 {"Info233741353746-9883461", 86739, 2359},
 {"Info83741287860-4776429", 86908, 2362}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 131, 0, 98, "Title",ExpressionUUID->"64364337-75f9-4d80-b087-fea8447864fa"],
Cell[714, 24, 151, 3, 30, "Input",ExpressionUUID->"cd46333a-252c-45d8-946e-49de93b6176b"],
Cell[CellGroupData[{
Cell[890, 31, 104, 0, 67, "Section",ExpressionUUID->"a4f0ad77-ad85-45ce-bfdb-36c910ffb77f"],
Cell[CellGroupData[{
Cell[1019, 35, 188, 3, 32, "Item",ExpressionUUID->"06f8f470-abc3-4983-8da2-c8af27fe45c8"],
Cell[1210, 40, 160, 3, 32, "Item",ExpressionUUID->"cdc2e9c4-3c90-43ff-aa3a-0351540e451e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1407, 48, 107, 0, 54, "Subsection",ExpressionUUID->"e7238b3c-5c7f-4a76-a767-abd2172f4002"],
Cell[1517, 50, 219, 3, 32, "Item",ExpressionUUID->"e4a371dc-be4f-4521-ad70-a685f6cb9920"],
Cell[CellGroupData[{
Cell[1761, 57, 147, 3, 30, "Input",ExpressionUUID->"877bb8c6-2412-4983-8dc6-f3b281bcbdb2"],
Cell[1911, 62, 417, 7, 34, "Output",ExpressionUUID->"7212e9b9-a795-4745-a6fd-2d3578167aab"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2377, 75, 120, 0, 54, "Subsection",ExpressionUUID->"7f2b7798-db3f-4574-b0e8-c28093423255"],
Cell[2500, 77, 169, 3, 32, "Item",ExpressionUUID->"530c10f3-93c7-4dc5-b8d3-5e1bd26e2af4"],
Cell[CellGroupData[{
Cell[2694, 84, 194, 4, 30, "Input",ExpressionUUID->"4e5a052d-bb9c-4b87-878f-5330841f4a17"],
Cell[2891, 90, 2010, 55, 58, "Output",ExpressionUUID->"7e15b077-c6ef-440d-9368-57788b022fd6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4950, 151, 92, 0, 54, "Subsection",ExpressionUUID->"83e8506d-3563-4979-8cdb-2a7dd79c0cb8"],
Cell[5045, 153, 121, 0, 32, "Item",ExpressionUUID->"6c051465-ae6d-42ab-888b-98112b0ee75f"],
Cell[CellGroupData[{
Cell[5191, 157, 198, 4, 30, "Input",ExpressionUUID->"3c1da890-0914-46c5-84c0-8db14781b788"],
Cell[5392, 163, 415, 7, 34, "Output",ExpressionUUID->"5aa57693-3e51-41f6-bb86-bf79352b4799"]
}, Open  ]],
Cell[5822, 173, 112, 0, 32, "Item",ExpressionUUID->"e21a3f4a-74d3-4da7-b726-ce738b7a8c13"],
Cell[CellGroupData[{
Cell[5959, 177, 265, 6, 30, "Input",ExpressionUUID->"21e4684a-2332-472d-83b0-31cbc63e06f3"],
Cell[CellGroupData[{
Cell[6249, 187, 845, 17, 25, "Print",ExpressionUUID->"52adac1e-0618-4009-bf15-59b12abedab1"],
Cell[7097, 206, 516, 11, 24, "Print",ExpressionUUID->"77b503c9-7118-46eb-86a5-360735165ccb"],
Cell[7616, 219, 418, 10, 24, "Print",ExpressionUUID->"a9fefae1-280e-486f-9b90-c3c9d04f3366"]
}, Open  ]],
Cell[8049, 232, 124, 2, 34, "Output",ExpressionUUID->"dbeb2240-56e5-41fe-8584-90e3c6d53ad4"]
}, Open  ]],
Cell[8188, 237, 205, 3, 32, "Item",ExpressionUUID->"c4d3e177-e1d0-471b-8f5e-3b27f5b23a97"],
Cell[CellGroupData[{
Cell[8418, 244, 269, 6, 30, "Input",ExpressionUUID->"d791d3a4-696a-439d-8eb8-a654f6cb1f4f"],
Cell[8690, 252, 1553, 32, 58, "Output",ExpressionUUID->"75065bf2-35f7-4537-b08c-1f98561f4598"]
}, Open  ]],
Cell[10258, 287, 103, 0, 32, "Item",ExpressionUUID->"d4cd4736-74b8-48ea-9f88-a4c4719bbaf9"],
Cell[CellGroupData[{
Cell[10386, 291, 322, 7, 30, "Input",ExpressionUUID->"945e0f6f-2ce1-4125-9b27-909b8648dd4d"],
Cell[10711, 300, 3132, 79, 60, "Output",ExpressionUUID->"2fd3db71-a67d-4592-a904-361b33d62fbf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13892, 385, 176, 3, 54, "Subsection",ExpressionUUID->"85581c31-27fe-48b5-9892-86d8c988afbc"],
Cell[CellGroupData[{
Cell[14093, 392, 409, 11, 32, "Item",ExpressionUUID->"ece2d8d3-4834-4691-96e8-2f6058a56262"],
Cell[14505, 405, 185, 3, 32, "Item",ExpressionUUID->"e15f2ede-78f5-4b8d-bb4a-ee77c2ae7998"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14727, 413, 220, 4, 30, "Input",ExpressionUUID->"e47244e7-4886-4fc6-9ce8-cefd0b075797"],
Cell[14950, 419, 499, 13, 47, "Print",ExpressionUUID->"78da4e12-f6d1-4213-b0a7-20e39f05ce10",
 CellTags->"Info233741353746-9883461"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15486, 437, 223, 4, 30, "Input",ExpressionUUID->"8ef8421e-675c-4a4f-be5e-ed0baacf7421"],
Cell[15712, 443, 650, 11, 34, "Output",ExpressionUUID->"c772aed5-3b83-4c47-8d26-42abbf552d55"]
}, Open  ]],
Cell[16377, 457, 179, 3, 32, "Item",ExpressionUUID->"602e8bb8-506f-4ead-bc6e-8ea92cefd02c"],
Cell[CellGroupData[{
Cell[16581, 464, 275, 5, 30, "Input",ExpressionUUID->"8a80c76f-8705-4dd0-bc97-8bb738f97cf4"],
Cell[16859, 471, 3134, 71, 58, "Output",ExpressionUUID->"f6b6bf21-fe2d-48ef-9044-5540ee95d16a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20042, 548, 163, 3, 54, "Subsection",ExpressionUUID->"67a600cb-6567-4000-8b1b-91c4b30ecb31"],
Cell[CellGroupData[{
Cell[20230, 555, 182, 3, 32, "Item",ExpressionUUID->"133552d6-dcc8-4ff0-bb97-c4c1913e4968"],
Cell[20415, 560, 194, 3, 32, "Item",ExpressionUUID->"54b11ce8-e24d-431b-84ac-ef234b6e6f94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20646, 568, 339, 7, 30, "Input",ExpressionUUID->"06276b50-11d1-406a-92fe-024e2253eb6e"],
Cell[20988, 577, 1912, 52, 88, "Output",ExpressionUUID->"e49464b8-35b0-4c74-bf0a-c234f7d38913"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22937, 634, 337, 7, 30, "Input",ExpressionUUID->"f1be69db-c4a8-451b-acbc-91671972f903"],
Cell[23277, 643, 2745, 73, 96, "Output",ExpressionUUID->"a999b038-f14c-48aa-97a7-8ba4b24a435c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26071, 722, 98, 0, 54, "Subsection",ExpressionUUID->"fb11b5e5-e77e-461a-b17c-c68a649405b1"],
Cell[CellGroupData[{
Cell[26194, 726, 171, 3, 32, "Item",ExpressionUUID->"cb070e49-51e6-4432-9977-4ed324a50505"],
Cell[26368, 731, 113, 0, 32, "Item",ExpressionUUID->"43a2662b-6a28-43f6-9692-494d87ccce52"],
Cell[26484, 733, 453, 10, 32, "Item",ExpressionUUID->"9439f06c-b0fc-4370-bad2-f09db89ba4e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26974, 748, 279, 7, 30, "Input",ExpressionUUID->"b6826ceb-5d93-4911-9eb4-80285fac3499"],
Cell[27256, 757, 2169, 59, 58, "Output",ExpressionUUID->"c6d80986-b04d-4fbe-b159-c0e52e55bdf2"]
}, Open  ]],
Cell[29440, 819, 179, 2, 32, "Item",ExpressionUUID->"e3eb31e5-33f0-45fd-b099-fe0f07ce28ef"],
Cell[CellGroupData[{
Cell[29644, 825, 273, 6, 30, "Input",ExpressionUUID->"ba7828bb-6f00-4346-a2c8-b42bcb3e0167"],
Cell[29920, 833, 2472, 65, 67, "Output",ExpressionUUID->"f8a96ab9-54f2-430e-a479-1b64b4465ce1"]
}, Open  ]],
Cell[32407, 901, 142, 2, 32, "Item",ExpressionUUID->"62a21fd8-d5dc-4677-80c9-50f2ceb8603c"],
Cell[CellGroupData[{
Cell[32574, 907, 147, 3, 30, "Input",ExpressionUUID->"08bde882-e450-485a-bc85-b0c6dc590582"],
Cell[32724, 912, 473, 12, 47, "Print",ExpressionUUID->"f10f1477-368b-41db-a78b-94b6f4610593",
 CellTags->"Info103740837608-2791083"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33234, 929, 321, 8, 30, "Input",ExpressionUUID->"0cbcf7e6-ec9d-4e70-8e75-56128c6e8aee"],
Cell[33558, 939, 1525, 41, 58, "Output",ExpressionUUID->"7e164b16-cb64-45b7-ad8e-0755672eb2f8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35132, 986, 88, 0, 54, "Subsection",ExpressionUUID->"e6878f83-36d6-4701-8500-3382d0d99f26"],
Cell[CellGroupData[{
Cell[35245, 990, 859, 25, 35, "Item",ExpressionUUID->"26ac1ad8-402f-4a1d-bd7d-272cd948aa0e"],
Cell[36107, 1017, 153, 2, 32, "Item",ExpressionUUID->"f9bed6bd-4cab-47f9-b71e-b8836774e219"],
Cell[36263, 1021, 353, 9, 32, "Item",ExpressionUUID->"7d366a3a-5072-4f88-8f25-cb2663099628"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36653, 1035, 146, 3, 30, "Input",ExpressionUUID->"0fba2ee2-dbd8-47dd-afbf-0ba92878e7e0"],
Cell[36802, 1040, 436, 11, 47, "Print",ExpressionUUID->"6fefa591-85d9-41e4-8c3f-264e05de5b2a",
 CellTags->"Info123740837609-2791083"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37275, 1056, 188, 4, 30, "Input",ExpressionUUID->"2e84bb83-d542-4f5a-8e06-4b5f002deb93"],
Cell[37466, 1062, 1145, 24, 37, "Output",ExpressionUUID->"3a0827b9-b895-410d-acb2-ef47149957ce"]
}, Open  ]],
Cell[38626, 1089, 99, 0, 32, "Item",ExpressionUUID->"dfece94b-22b1-4ec7-995d-3543287108b7"],
Cell[CellGroupData[{
Cell[38750, 1093, 188, 4, 30, "Input",ExpressionUUID->"5344573d-204a-473c-8538-fb0c8c1cb74d"],
Cell[38941, 1099, 1145, 24, 37, "Output",ExpressionUUID->"0d1163cd-5f7b-4cac-852a-bca761a7d720"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40123, 1128, 355, 9, 30, "Input",ExpressionUUID->"3c8fba1d-f372-402a-a394-f7f36d640a6b"],
Cell[40481, 1139, 6009, 155, 108, "Output",ExpressionUUID->"4183e9f4-1b12-463d-88a6-d8e46412b12d"]
}, Open  ]],
Cell[46505, 1297, 664, 19, 35, "Item",ExpressionUUID->"ac5cab32-e3e3-4ca5-96b4-1a8a8444dfb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47206, 1321, 93, 0, 54, "Subsection",ExpressionUUID->"2603b6f6-44ff-4981-988d-9d0381f171b3"],
Cell[CellGroupData[{
Cell[47324, 1325, 156, 3, 30, "Input",ExpressionUUID->"61934c3a-3a5a-4ca6-99fc-0bf808b63202"],
Cell[47483, 1330, 452, 12, 47, "Print",ExpressionUUID->"12b1726a-bf48-4f10-b852-0590329f4c9e",
 CellTags->"Info163740837611-2791083"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47972, 1347, 201, 4, 30, "Input",ExpressionUUID->"72254832-64cf-463c-b22b-a038e480a575"],
Cell[48176, 1353, 5171, 133, 124, "Output",ExpressionUUID->"76afe0a2-3de9-423a-9fa7-1d2185090b7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53384, 1491, 364, 8, 34, "Item",ExpressionUUID->"259345f8-f7f9-437c-b0dc-18984e024ecc"],
Cell[53751, 1501, 149, 2, 32, "Item",ExpressionUUID->"1eb6d5f3-5c2c-4fc9-9579-c97c515f4742"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53937, 1508, 203, 4, 30, "Input",ExpressionUUID->"ff590090-19fc-4ec1-9e8e-a7fb3904f99b"],
Cell[54143, 1514, 698, 16, 70, "Print",ExpressionUUID->"e64a3cda-bc00-4dbf-869c-44420f18c2a4",
 CellTags->"Info83741287860-4776429"]
}, Open  ]],
Cell[54856, 1533, 275, 6, 32, "Item",ExpressionUUID->"3bcde278-b8fd-4db4-8125-5d7367fcf541"],
Cell[CellGroupData[{
Cell[55156, 1543, 197, 5, 30, "Input",ExpressionUUID->"2f2f4ec6-be89-4742-8c47-2034c2d79e71"],
Cell[55356, 1550, 1645, 27, 37, "Output",ExpressionUUID->"8b7b6d02-9020-484c-9f0a-d480f7d121a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57038, 1582, 255, 7, 30, "Input",ExpressionUUID->"61e32f7c-35c6-4545-acc1-3b958bab0cb2"],
Cell[57296, 1591, 3944, 92, 68, "Output",ExpressionUUID->"751349d3-7b77-4771-a4b2-7d53be63c436"]
}, Open  ]],
Cell[61255, 1686, 369, 10, 32, "Item",ExpressionUUID->"25ee559b-f0f6-4652-b9c5-4c60b3d9d027"],
Cell[CellGroupData[{
Cell[61649, 1700, 316, 9, 30, "Input",ExpressionUUID->"2c8887bf-8ae4-4592-ae64-fd7bd406a536"],
Cell[61968, 1711, 3601, 94, 60, "Output",ExpressionUUID->"40a5cc2a-b2e0-4f07-810f-5d819d6a8ef2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65630, 1812, 90, 0, 67, "Section",ExpressionUUID->"e7181691-5dfd-49fe-b8df-2574478bbc10"],
Cell[CellGroupData[{
Cell[65745, 1816, 157, 2, 32, "Item",ExpressionUUID->"36a78f48-bde0-4d93-89ff-ffe9122b286d"],
Cell[65905, 1820, 101, 0, 32, "Item",ExpressionUUID->"5a435a34-e2a1-4bda-9aa0-c8705bebb774"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66043, 1825, 93, 0, 54, "Subsection",ExpressionUUID->"197169e0-d9fa-45c0-ba2a-bdd337ddf1f7"],
Cell[CellGroupData[{
Cell[66161, 1829, 152, 3, 30, "Input",ExpressionUUID->"b7f54844-ccf2-4fc9-943b-d85628aabb10"],
Cell[66316, 1834, 413, 7, 34, "Output",ExpressionUUID->"d4354284-9d65-4b00-876e-11cb7d90b33a"]
}, Open  ]],
Cell[66744, 1844, 120, 0, 32, "Item",ExpressionUUID->"0c24c777-815e-4829-b558-239eb356569b"],
Cell[CellGroupData[{
Cell[66889, 1848, 201, 4, 30, "Input",ExpressionUUID->"5e296270-c772-4d09-acc3-5d263233a5ed"],
Cell[67093, 1854, 414, 7, 35, "Output",ExpressionUUID->"9701ee26-49d1-41ff-bf73-ee19a6b8d772"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67556, 1867, 119, 0, 54, "Subsection",ExpressionUUID->"2aedad6a-ba82-4c57-91e6-689a18366bb1"],
Cell[CellGroupData[{
Cell[67700, 1871, 161, 3, 32, "Item",ExpressionUUID->"a812087f-ac5c-4f76-bb5b-ff081e9ce1b1"],
Cell[67864, 1876, 111, 0, 32, "Item",ExpressionUUID->"39fbe266-de2e-45fe-88ca-ccb0d8fdbbff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68012, 1881, 191, 4, 30, "Input",ExpressionUUID->"c1b5724b-4e40-43dc-b6ca-22f41d85b152"],
Cell[68206, 1887, 2047, 47, 75, "Output",ExpressionUUID->"a1242871-68d6-4861-b91a-1afd52b9de8f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70302, 1940, 82, 0, 54, "Subsection",ExpressionUUID->"78cc6ba2-e5ff-408e-aa99-4f34634545ec"],
Cell[CellGroupData[{
Cell[70409, 1944, 198, 3, 32, "Item",ExpressionUUID->"aab919d1-a288-46d3-aadd-47cc250cfcb6"],
Cell[70610, 1949, 118, 0, 32, "Item",ExpressionUUID->"8503d4dd-65a4-4b6a-a39f-5fb36c7acf1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70765, 1954, 397, 10, 30, "Input",ExpressionUUID->"bfb529f6-742b-448b-989e-9276a232bb13"],
Cell[71165, 1966, 3273, 79, 55, "Output",ExpressionUUID->"8fa29104-2c46-49ab-a711-3ffdbfd45eb7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74487, 2051, 87, 0, 54, "Subsection",ExpressionUUID->"3a70b2f1-3b5f-428c-8983-ecc5eff15184"],
Cell[74577, 2053, 160, 3, 32, "Item",ExpressionUUID->"6b94d810-cd82-49f9-ad5e-7477ab85b3c9"],
Cell[CellGroupData[{
Cell[74762, 2060, 323, 8, 30, "Input",ExpressionUUID->"bcdeb50a-4db8-4063-bde0-c3861f3f0b84"],
Cell[75088, 2070, 1135, 24, 37, "Output",ExpressionUUID->"6467927c-1a5c-4e0d-8cc8-47947dc45ebd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76260, 2099, 659, 20, 30, "Input",ExpressionUUID->"f7f9a96a-b0a2-4c86-9143-e3d35c7e2e71"],
Cell[76922, 2121, 8933, 212, 107, "Output",ExpressionUUID->"5021e961-534d-4fb3-adb6-045c3ca5b94d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

